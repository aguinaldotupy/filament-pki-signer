var $t=Object.create;var _t=Object.defineProperty;var ei=Object.getOwnPropertyDescriptor;var ti=Object.getOwnPropertyNames;var ii=Object.getPrototypeOf,ni=Object.prototype.hasOwnProperty;var Me=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,i)=>(typeof require<"u"?require:t)[i]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var si=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var ri=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of ti(t))!ni.call(e,r)&&r!==i&&_t(e,r,{get:()=>t[r],enumerable:!(s=ei(t,r))||s.enumerable});return e};var oi=(e,t,i)=>(i=e!=null?$t(ii(e)):{},ri(t||!e||!e.__esModule?_t(i,"default",{value:e,enumerable:!0}):i,e));var jt=si(Ee=>{typeof window.lacunaWebPKIExtension>"u"&&(window.lacunaWebPKIExtension=null);window.LacunaWebPKI=null;LacunaWebPKI=function(e){if(this.license=null,this.defaultFailCallback=null,this.angularScope=null,this.ngZone=null,this.brand=null,this.restPkiUrl=null,this.useDomainNativePool=!1,this.mobileIntegrationMode=null,e&&(this.license=e),this.isSupportedMobile&&window.$&&window.$.blockUI)try{window.$.blockUI.defaults.bindEvents=!1,this._log("blockUI bindEvents disabled")}catch(t){this._log("Error disabling blockUI bindEvents: ",t)}};(function(e){e.Promise=function(n,a){this.successCallback=function(){},this.failCallback=null,this.angularScope=n,this.ngZone=a},e.Promise.prototype.success=function(n){return this.successCallback=n,this},e.Promise.prototype.error=function(n){return this.failCallback=function(a){n(a.message,a.error,a.origin,a.code)},this},e.Promise.prototype.fail=function(n){return this.failCallback=n,this},e.Promise.prototype._invokeSuccess=function(n,a){if(a>0){var c=this;setTimeout(function(){c._invokeSuccess(n)},a)}else{var b=this.successCallback||function(){e._log("Success ignored (no callback registered)")};this._apply(function(){b(n)})}},e.Promise.prototype._invokeError=function(n,a){if(a>0){var c=this;setTimeout(function(){c._invokeError(n)},a)}else{var b=this.failCallback||function(E){throw"Web PKI error originated at "+E.origin+": "+E.message+`
`+E.complete+`
code: `+E.code};this._apply(function(){b({userMessage:n.userMessage||n.message,message:n.message,error:n.complete,origin:n.origin,code:n.code})})}},e.Promise.prototype._apply=function(n){if(this.angularScope){var a=this.angularScope.$root.$$phase;a=="$apply"||a=="$digest"?n():this.angularScope.$apply(function(){n()})}else this.ngZone?this.ngZone.run(function(){n()}):n()},e._installUrl="https://get.webpkiplugin.com/",e._chromeExtensionId="dcngeagmmhegagicpcmpinaoklddcgon",e._firefoxExtensionId="webpki-beta@lacunasoftware.com",e._edgeExtensionId="nedeegdmhlnmboboahchfpkmdnnemapd",e._edgeLegacyProductId="d2798a85-9698-425a-add7-3db79a39ca8a",e._chromeExtensionFirstVersionWithSelfUpdate="2.0.20",e._jslibVersion="2.16.3",e._mobileSupported=!0,e._buildChannel="stable",e._extensionRequiredVersion="2.16.0",e._chromeNativeWinRequiredVersion="2.12.3",e._chromeNativeLinuxRequiredVersion="2.13.3",e._chromeNativeMacRequiredVersion="2.13.3",e._ieAddonRequiredVersion="2.9.1",e._mobileRequiredVersion="3.2.0",e._chromeInstallationStates={INSTALLED:0,EXTENSION_NOT_INSTALLED:1,EXTENSION_OUTDATED:2,NATIVE_NOT_INSTALLED:3,NATIVE_OUTDATED:4},e._certKeyUsages={crlSign:2,dataEncipherment:16,decipherOnly:32768,digitalSignature:128,encipherOnly:1,keyAgreement:8,keyCertSign:4,keyEncipherment:32,nonRepudiation:64},e._certExtendedKeyUsages={clientAuth:1,serverAuth:2,codeSigning:4,emailProtection:8,timeStamping:16,ocspSigning:32,ipsecEndSystem:64,ipsecTunnel:128,ipsecUser:256,any:512},e.apiVersions={v1_0:"1.0",v1_1:"1.1",v1_2:"1.2",v1_3:"1.3",v1_4:"1.4",v1_4_1:"1.4.1",v1_5:"1.5",v1_5_1:"1.5.1",v1_5_2:"1.5.2",v1_6:"1.6.0",v1_6_1:"1.6.1",v1_7_0:"1.7.0",v1_7_2:"1.7.2",v1_8_0:"1.8.0",v1_8_1:"1.8.1",v1_8_2:"1.8.2",v1_9_0:"1.9.0",latest:"latest"},e._apiMap={nativeWin:{},nativeLinux:{},nativeMac:{},ieAddon:{},extension:{},mobile:{}},e._apiMap.nativeWin[e.apiVersions.v1_0]="2.1.0",e._apiMap.nativeWin[e.apiVersions.v1_1]="2.3.0",e._apiMap.nativeWin[e.apiVersions.v1_2]="2.4.1",e._apiMap.nativeWin[e.apiVersions.v1_3]="2.5.0",e._apiMap.nativeWin[e.apiVersions.v1_4]="2.6.2",e._apiMap.nativeWin[e.apiVersions.v1_4_1]="2.6.5",e._apiMap.nativeWin[e.apiVersions.v1_5]="2.8.0",e._apiMap.nativeWin[e.apiVersions.v1_5_1]="2.8.1",e._apiMap.nativeWin[e.apiVersions.v1_5_2]="2.9.0",e._apiMap.nativeWin[e.apiVersions.v1_6]="2.10.0",e._apiMap.nativeWin[e.apiVersions.v1_6_1]="2.10.1",e._apiMap.nativeWin[e.apiVersions.v1_7_0]="2.11.0",e._apiMap.nativeWin[e.apiVersions.v1_7_2]="2.11.0",e._apiMap.nativeWin[e.apiVersions.v1_8_0]="2.12.0",e._apiMap.nativeWin[e.apiVersions.v1_8_1]="2.12.1",e._apiMap.nativeWin[e.apiVersions.v1_8_2]="2.12.3",e._apiMap.nativeWin[e.apiVersions.v1_9_0]="2.12.3",e._apiMap.ieAddon[e.apiVersions.v1_0]="2.0.4",e._apiMap.ieAddon[e.apiVersions.v1_1]="2.1.1",e._apiMap.ieAddon[e.apiVersions.v1_2]="2.2.4",e._apiMap.ieAddon[e.apiVersions.v1_3]="2.3.0",e._apiMap.ieAddon[e.apiVersions.v1_4]="2.4.2",e._apiMap.ieAddon[e.apiVersions.v1_4_1]="2.4.5",e._apiMap.ieAddon[e.apiVersions.v1_5]="2.5.0",e._apiMap.ieAddon[e.apiVersions.v1_5_1]="2.5.2",e._apiMap.ieAddon[e.apiVersions.v1_5_2]="2.6.0",e._apiMap.ieAddon[e.apiVersions.v1_6]="2.7.0",e._apiMap.ieAddon[e.apiVersions.v1_6_1]="2.7.2",e._apiMap.ieAddon[e.apiVersions.v1_7_0]="2.8.0",e._apiMap.ieAddon[e.apiVersions.v1_7_2]="2.8.0",e._apiMap.ieAddon[e.apiVersions.v1_8_0]="2.9.0",e._apiMap.ieAddon[e.apiVersions.v1_8_1]="2.9.1",e._apiMap.ieAddon[e.apiVersions.v1_8_2]="2.9.1",e._apiMap.ieAddon[e.apiVersions.v1_9_0]="2.9.1",e._apiMap.nativeLinux[e.apiVersions.v1_0]="2.0.0",e._apiMap.nativeLinux[e.apiVersions.v1_1]="2.4.0",e._apiMap.nativeLinux[e.apiVersions.v1_2]="2.6.2",e._apiMap.nativeLinux[e.apiVersions.v1_3]="2.7.0",e._apiMap.nativeLinux[e.apiVersions.v1_4]="2.7.4",e._apiMap.nativeLinux[e.apiVersions.v1_4_1]="2.7.4",e._apiMap.nativeLinux[e.apiVersions.v1_5]="2.9.0",e._apiMap.nativeLinux[e.apiVersions.v1_5_1]="2.9.0",e._apiMap.nativeLinux[e.apiVersions.v1_5_2]="2.9.5",e._apiMap.nativeLinux[e.apiVersions.v1_6]="2.10.0",e._apiMap.nativeLinux[e.apiVersions.v1_6_1]="2.10.0",e._apiMap.nativeLinux[e.apiVersions.v1_7_0]="2.12.0",e._apiMap.nativeLinux[e.apiVersions.v1_7_2]="2.12.1",e._apiMap.nativeLinux[e.apiVersions.v1_8_0]="2.13.0",e._apiMap.nativeLinux[e.apiVersions.v1_8_1]="2.13.1",e._apiMap.nativeLinux[e.apiVersions.v1_8_2]="2.13.3",e._apiMap.nativeLinux[e.apiVersions.v1_9_0]="2.13.3",e._apiMap.nativeMac[e.apiVersions.v1_0]="2.3.0",e._apiMap.nativeMac[e.apiVersions.v1_1]="2.4.0",e._apiMap.nativeMac[e.apiVersions.v1_2]="2.6.1",e._apiMap.nativeMac[e.apiVersions.v1_3]="2.7.0",e._apiMap.nativeMac[e.apiVersions.v1_4]="2.7.4",e._apiMap.nativeMac[e.apiVersions.v1_4_1]="2.7.4",e._apiMap.nativeMac[e.apiVersions.v1_5]="2.9.0",e._apiMap.nativeMac[e.apiVersions.v1_5_1]="2.9.0",e._apiMap.nativeMac[e.apiVersions.v1_5_2]="2.9.5",e._apiMap.nativeMac[e.apiVersions.v1_6]="2.10.0",e._apiMap.nativeMac[e.apiVersions.v1_6_1]="2.10.0",e._apiMap.nativeMac[e.apiVersions.v1_7_0]="2.12.0",e._apiMap.nativeMac[e.apiVersions.v1_7_2]="2.12.1",e._apiMap.nativeMac[e.apiVersions.v1_8_0]="2.13.0",e._apiMap.nativeMac[e.apiVersions.v1_8_1]="2.13.1",e._apiMap.nativeMac[e.apiVersions.v1_8_2]="2.13.3",e._apiMap.nativeMac[e.apiVersions.v1_9_0]="2.13.3",e._apiMap.extension[e.apiVersions.v1_0]="2.3.2",e._apiMap.extension[e.apiVersions.v1_1]="2.7.0",e._apiMap.extension[e.apiVersions.v1_2]="2.9.1",e._apiMap.extension[e.apiVersions.v1_3]="2.10.1",e._apiMap.extension[e.apiVersions.v1_4]="2.11.7",e._apiMap.extension[e.apiVersions.v1_4_1]="2.11.7",e._apiMap.extension[e.apiVersions.v1_5]="2.13.0",e._apiMap.extension[e.apiVersions.v1_5_1]="2.13.0",e._apiMap.extension[e.apiVersions.v1_5_2]="2.14.2",e._apiMap.extension[e.apiVersions.v1_6]="2.15.0",e._apiMap.extension[e.apiVersions.v1_6_1]="2.15.0",e._apiMap.extension[e.apiVersions.v1_7_0]="2.16.0",e._apiMap.extension[e.apiVersions.v1_7_2]="2.16.0",e._apiMap.extension[e.apiVersions.v1_8_0]="2.16.0",e._apiMap.extension[e.apiVersions.v1_8_1]="2.16.0",e._apiMap.extension[e.apiVersions.v1_8_2]="2.16.0",e._apiMap.extension[e.apiVersions.v1_9_0]="2.17.0",e._apiMap.mobile[e.apiVersions.v1_0]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_1]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_2]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_3]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_4]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_4_1]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_5]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_5_1]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_5_2]="1.1.0",e._apiMap.mobile[e.apiVersions.v1_6]="2.7.0",e._apiMap.mobile[e.apiVersions.v1_6_1]="2.7.0",e._apiMap.mobile[e.apiVersions.v1_7_0]="3.0.0",e._apiMap.mobile[e.apiVersions.v1_7_2]="3.0.0",e._apiMap.mobile[e.apiVersions.v1_8_0]="3.2.0",e._apiMap.mobile[e.apiVersions.v1_8_1]="3.2.0",e._apiMap.mobile[e.apiVersions.v1_8_2]="3.2.0",e._apiMap.mobile[e.apiVersions.v1_9_0]="3.2.0",e._apiMap.nativeWin[e.apiVersions.latest]=e._chromeNativeWinRequiredVersion,e._apiMap.ieAddon[e.apiVersions.latest]=e._ieAddonRequiredVersion,e._apiMap.nativeLinux[e.apiVersions.latest]=e._chromeNativeLinuxRequiredVersion,e._apiMap.nativeMac[e.apiVersions.latest]=e._chromeNativeMacRequiredVersion,e._apiMap.extension[e.apiVersions.latest]=e._extensionRequiredVersion,e._apiMap.mobile[e.apiVersions.latest]=e._mobileRequiredVersion,e._nativeInfo={},e.installationStates={INSTALLED:0,NOT_INSTALLED:1,OUTDATED:2,BROWSER_NOT_SUPPORTED:3},e.isSupportedMobile=void 0,e.certificateValidationLevels={full:"full",offline:"offline"},e.padesPolicies={basic:"basic",brazilAdrBasica:"brazilAdrBasica"},e.cadesPolicies={bes:"cadesBes",brazilAdrBasica:"brazilAdrBasica"},e.xmlPolicies={xmlDSig:"xmlDSig",xadesBes:"xadesBes",brazilNFe:"brazilNFe",brazilAdrBasica:"brazilAdrBasica"},e.cadesAcceptablePolicies={pkiBrazil:["brazilAdrBasica","brazilAdrTempo","brazilAdrValidacao","brazilAdrCompleta","brazilAdrArquivamento"]},e.xmlAcceptablePolicies={pkiBrazil:["brazilAdrBasica","brazilAdrTempo"]},e.standardTrustArbitrators={pkiBrazil:{type:"standard",standardArbitrator:"pkiBrazil"},pkiItaly:{type:"standard",standardArbitrator:"pkiItaly"},pkiPeru:{type:"standard",standardArbitrator:"pkiPeru"},windows:{type:"standard",standardArbitrator:"windows"}},e.xmlInsertionOptions={appendChild:"appendChild",prependChild:"prependChild",appendSibling:"appendSibling",prependSibling:"prependSibling"},e.outputModes={showSaveFileDialog:"showSaveFileDialog",saveInFolder:"saveInFolder",autoSave:"autoSave",returnContent:"returnContent"},e.trustArbitratorTypes={trustedRoot:"trustedRoot",tsl:"tsl",standard:"standard"},e.padesPaperSizes={custom:"custom",a0:"a0",a1:"a1",a2:"a2",a3:"a3",a4:"a4",a5:"a5",a6:"a6",a7:"a7",a8:"a8",letter:"letter",legal:"legal",ledger:"ledger"},e.padesHorizontalAlign={left:"left",center:"center",rigth:"rigth"},e.padesVerticalAlign={top:"top",center:"center",bottom:"bottom"},e.padesMeasurementUnits={centimeters:"centimeters",pdfPoints:"pdfPoints"},e.padesPageOrientations={auto:"auto",portrait:"portrait",landscape:"landscape"},e.padesAutoPositioningHorizontalDirections={leftToRight:"leftToRight",rightToLeft:"rightToLeft"},e.padesAutoPositioningVerticalDirections={topDown:"topDown",bottomUp:"bottomUp"},e.markElementTypes={text:"text",image:"image"},e.markTextStyle={normal:0,bold:1,italic:2},e.passwordPolicies={lettersAndNumbers:1,upperAndLowerCase:2,specialCharacters:4},e.pkcs11Modules={safeSign:{win:"aetpkss1.dll",linux:"libaetpkss.so.3",mac:"libaetpkss.dylib"},safeNet:{win:"eTPKCS11.dll",linux:"libeToken.so",mac:"libeToken.dylib"}},e.mobileIntegrationModes={appIntegration:"appIntegration",browserIntegration:"browserIntegration"},e.encryptionParameters={rsaEncryptionPkcs1:"RSAEncryptionPkcs1",rsaEncryptionOaepSHA1:"RSAEncryptionOaepSHA1",rsaEncryptionOaepSHA256:"RSAEncryptionOaepSHA256",rsaEncryptionOaepSHA384:"RSAEncryptionOaepSHA384",rsaEncryptionOaepSHA512:"RSAEncryptionOaepSHA512"},e._parseDataUrl=function(n){var a=/^data:(.+);base64,(.+)$/.exec(n);return a?{mimeType:a[1],content:a[2]}:(e._log("failed to parse data url"),null)},e._downloadResource=function(n,a){e._log("resolving resource reference: "+n);var c=new XMLHttpRequest;c.open("GET",n),c.responseType="blob",c.onload=function(){var b=new FileReader;b.onloadend=function(){e._log("resource reference resolved");var E=e._parseDataUrl(b.result);a(E)},b.readAsDataURL(c.response)},c.send()},e._getRequestOsP11Modules=function(n){if(!n||!n.length)return null;for(var a=[],c=0;c<n.length;c++)e._nativeInfo.os==="Windows"?a.push(n[c].win):e._nativeInfo.os==="Linux"?a.push(n[c].linux):e._nativeInfo.os==="Darwin"&&a.push(n[c].mac);return a},e._handleP11ModulesArgs=function(n,a){var c=null,b=null;n.token&&typeof n.token=="object"&&(c=[n.token.pkcs11Module],b=n.token.serialNumber),a.pkcs11Modules=c||a.pkcs11Modules,a.tokenSerialNumber=b||a.tokenSerialNumber},e.errorCodes={UNDEFINED:"undefined",INTERNAL:"internal",USER_CANCELLED:"user_cancelled",OS_NOT_SUPPORTED:"os_not_supported",ADDON_TIMEOUT:"addon_timeout",ADDON_NOT_DETECTED:"addon_not_detected",ADDON_SEND_COMMAND_FAILURE:"addon_send_command_failure",CERTIFICATE_NOT_FOUND:"certificate_not_found",COMMAND_UNKNOWN:"command_unknown",COMMAND_NOT_SUPPORTED:"command_not_supported",COMMAND_PARAMETER_NOT_SET:"command_parameter_not_set",COMMAND_INVALID_PARAMETER:"command_invalid_parameter",COMMAND_PARAMETER_NOT_SUPPORTED:"command_parameter_not_supported",NATIVE_CONNECT_FAILURE:"native_connect_failure",NATIVE_DISCONNECTED:"native_disconnected",NATIVE_NO_RESPONSE:"native_no_response",REST_PKI_GET_PENDING_SIGNATURE:"rest_pki_get_pending_signature",REST_PKI_POST_SIGNATURE:"rest_pki_post_signature",REST_PKI_INVALID_CERTIFICATE:"rest_pki_invalid_certificate",LICENSE_NOT_SET:"license_not_set",LICENSE_INVALID:"license_invalid",LICENSE_RESTRICTED:"license_restricted",LICENSE_EXPIRED:"license_expired",LICENSE_DOMAIN_NOT_ALLOWED:"license_domain_not_allowed",VALIDATION_ERROR:"validation_error",P11_ERROR:"p11_error",P11_TOKEN_NOT_FOUND:"p11_token_not_found",P11_NOT_SUPPORTED:"p11_not_supported",KEYSET_NOT_FOUND:"keyset_not_found",ALGORITHM_NOT_SUPPORTED:"algorithm_not_supported",SIGNED_PDF_TO_MARK:"signed_pdf_to_mark",JSON_ERROR:"json_error",IO_ERROR:"io_error",KEYCHAIN_ERROR:"keychain_error",KEYCHAIN_SIGN_ERROR:"keychain_sign_error",DECODE_ERROR:"decode_error",CSP_KEYSET_NOT_DEFINED:"csp_keyset_not_defined",CSP_INVALID_ALGORITHM:"csp_invalid_algorithm",CSP_INVALID_PROVIDER_TYPE:"csp_invalid_provider_type",MOBILE_TIMEOUT:"mobile_timeout",MOBILE_NOT_AUTHORIZED:"mobile_not_authorized",MOBILE_SEND_MESSAGE:"mobile_send_message",COMMAND_DECRYPT_ERROR:"command_decrypt_error",BLOCKED_DOMAIN:"blocked_domain",INVALID_OPERATION:"invalid_operation"},e._compareVersions=function(n,a){var c=n.split("."),b=a.split(".");function E(A){return/^\d+$/.test(A)}function x(A){for(var C=0;C<A.length;++C)if(!E(A[C]))return!1;return!0}if(!x(c)||!x(b))return NaN;for(var T=0;T<c.length;++T){if(b.length===T)return 1;var k=parseInt(c[T],10),N=parseInt(b[T],10);if(k!==N)return k>N?1:-1}return c.length!=b.length?-1:0},e._log=function(n,a){window.console&&(a?window.console.log(n,a):window.console.log(n))},e._createContext=function(n){var a=new e.Promise(this.angularScope,this.ngZone);n&&n.success&&a.success(n.success),n&&n.fail?a.fail(n.fail):n&&n.error?a.error(n.error):a.fail(this.defaultFailCallback);var c={promise:a,license:this.license,useDomainNativePool:this.useDomainNativePool,instance:e._supportedMobileDetected?this:void 0};return c},e.init=function(n){n?typeof n=="function"&&(n={ready:n}):n={},n.license&&(this.license=n.license),n.defaultError&&(this.defaultFailCallback=function(E){n.defaultError(E.message,E.error,E.origin,E.code)}),n.defaultFail&&(this.defaultFailCallback=n.defaultFail),n.angularScope&&(this.angularScope=n.angularScope),n.ngZone&&(this.ngZone=n.ngZone),n.brand&&(this.brand=n.brand),n.restPkiUrl&&(this.restPkiUrl=n.restPkiUrl[n.restPkiUrl.length-1]==="/"?n.restPkiUrl:n.restPkiUrl+"/"),this.useDomainNativePool=n.useDomainNativePool===!0;var a=this,c=function(E){E.isInstalled?n.ready?n.ready():e._log("Web PKI ready (no callback registered)"):n.notInstalled?n.notInstalled(E.status,E.message,E.browserSpecificStatus):a.redirectToInstallPage()},b=this._createContext({success:c,fail:n.fail,error:n.error});return e._requestHandler.checkInstalled(b,n.requiredApiVersion),b.promise},e.getVersion=function(n){var a=this._createContext(n);return e._requestHandler.sendCommand(a,"getVersion",null),a.promise},e.listCertificates=function(n){if(!n)n={};else if(n.filter&&typeof n.filter!="function")throw typeof n.filter=="boolean"?'args.filter must be a function (hint: if you used "pki.filters.xxx()", try removing the "()")':"args.filter must be a function, received "+typeof n.filter;var a=this._createContext(n);return e._requestHandler.sendCommand(a,"listCertificates",null,function(c){return e._processCertificates(c,n.filter,n.selectId,n.selectOptionFormatter)}),a.promise},e._processCertificate=function(n){if(n.validityStart=new Date(n.validityStart),n.validityEnd=new Date(n.validityEnd),n.keyUsage=e._processKeyUsage(n.keyUsage),n.extendedKeyUsage=e._processExtendedKeyUsage(n.extendedKeyUsage),n.pkiBrazil&&n.pkiBrazil.dateOfBirth){var a=n.pkiBrazil.dateOfBirth;n.pkiBrazil.dateOfBirth=new Date(parseInt(a.slice(0,4),10),parseInt(a.slice(5,7),10)-1,parseInt(a.slice(8,10),10))}},e._processCertificates=function(n,a,c,b){for(var E=[],x=0;x<n.length;x++){var T=n[x];e._processCertificate(T),a?a(T)&&E.push(T):E.push(T)}if(E.sort(function(V,D){var _=V.subjectName,y=D.subjectName;return!_||!y?!_&&y?1:-1:(_=_.toLowerCase(),y=y.toLowerCase(),_>y?1:_<y||V.validityEnd>D.validityEnd?-1:V.validityEnd<D.validityEnd?1:0)}),c){b||(b=function(V){return V.subjectName+" (issued by "+V.issuerName+")"});for(var k=document.getElementById(c);k.options.length>0;)k.remove(0);for(var N=0;N<E.length;N++){var A=E[N],C=document.createElement("option");C.value=A.thumbprint,C.text=b(A),k.add(C)}}return E},e._processKeyUsage=function(n){return{crlSign:(n&e._certKeyUsages.crlSign)!==0,dataEncipherment:(n&e._certKeyUsages.dataEncipherment)!==0,decipherOnly:(n&e._certKeyUsages.decipherOnly)!==0,digitalSignature:(n&e._certKeyUsages.digitalSignature)!==0,encipherOnly:(n&e._certKeyUsages.encipherOnly)!==0,keyAgreement:(n&e._certKeyUsages.keyAgreement)!==0,keyCertSign:(n&e._certKeyUsages.keyCertSign)!==0,keyEncipherment:(n&e._certKeyUsages.keyEncipherment)!==0,nonRepudiation:(n&e._certKeyUsages.nonRepudiation)!==0}},e._processExtendedKeyUsage=function(n){return typeof n!="number"?null:{clientAuth:(n&e._certExtendedKeyUsages.clientAuth)!==0,serverAuth:(n&e._certExtendedKeyUsages.serverAuth)!==0,codeSigning:(n&e._certExtendedKeyUsages.codeSigning)!==0,emailProtection:(n&e._certExtendedKeyUsages.emailProtection)!==0,timeStamping:(n&e._certExtendedKeyUsages.timeStamping)!==0,ocspSigning:(n&e._certExtendedKeyUsages.ocspSigning)!==0,ipsecEndSystem:(n&e._certExtendedKeyUsages.ipsecEndSystem)!==0,ipsecTunnel:(n&e._certExtendedKeyUsages.ipsecTunnel)!==0,ipsecUser:(n&e._certExtendedKeyUsages.ipsecUser)!==0,any:(n&e._certExtendedKeyUsages.any)!==0}},e._processSignResult=function(n){return!n||!n.signatureInfo||(n.signatureInfo.signerCertificate&&e._processCertificate(n.signatureInfo.signerCertificate),n.signatureInfo.signingTime&&(n.signatureInfo.signingTime=new Date(n.signatureInfo.signingTime))),n},e._processSignerModel=function(n){if(n&&(n.certificate&&e._processCertificate(n.certificate),n.signingTime&&(n.signingTime=new Date(n.signingTime)),n.certifiedDateReference&&(n.certifiedDateReference=new Date(n.certifiedDateReference)),n.timestamps&&n.timestamps.length>0))for(var a=0;a<n.timestamps.length;a++){var c=n.timestamps[a];e._processOpenResult(c)}},e._processOpenResult=function(n){if(!n||!n.signers||n.signers.length<=0)return n;n.genTime&&(n.genTime=new Date(n.genTime));for(var a=0;a<n.signers.length;a++){var c=n.signers[a];e._processSignerModel(c)}return n},e.filters={isPkiBrazilPessoaFisica:function(n){if(typeof n>"u")throw'filter called without cert argument (hint: if you are using "pki.filters.isPkiBrazilPessoaFisica()", try "pki.filters.isPkiBrazilPessoaFisica")';return n.pkiBrazil&&(n.pkiBrazil.cpf||"")!==""&&(n.pkiBrazil.cnpj||"")===""},hasPkiBrazilCpf:function(n){if(typeof n>"u")throw'filter called without cert argument (hint: if you are using "pki.filters.hasPkiBrazilCpf()", try "pki.filters.hasPkiBrazilCpf")';return n.pkiBrazil&&(n.pkiBrazil.cpf||"")!==""},hasPkiBrazilCnpj:function(n){if(typeof n>"u")throw'filter called without cert argument (hint: if you are using "pki.filters.hasPkiBrazilCnpj()", try "pki.filters.hasPkiBrazilCnpj")';return n.pkiBrazil&&(n.pkiBrazil.cnpj||"")!==""},pkiBrazilCpfEquals:function(n){if(typeof n!="string")throw`cpf must be a string (hint: if you are using "pki.filters.pkiBrazilCpfEquals", try "pki.filters.pkiBrazilCpfEquals('somecpf')")`;return function(a){return a.pkiBrazil&&a.pkiBrazil.cpf===n}},pkiBrazilCnpjEquals:function(n){if(typeof n!="string")throw`cnpj must be a string (hint: if you are using "pki.filters.pkiBrazilCnpjEquals", try "pki.filters.pkiBrazilCnpjEquals('somecnpj')")`;return function(a){return a.pkiBrazil&&a.pkiBrazil.cnpj===n}},hasPkiItalyCodiceFiscale:function(n){if(typeof n>"u")throw'filter called without cert argument (hint: if you are using "pki.filters.hasPkiItalyCodiceFiscale()", try "pki.filters.hasPkiItalyCodiceFiscale")';return n.pkiItaly&&(n.pkiItaly.codiceFiscale||"")!==""},pkiItalyCodiceFiscaleEquals:function(n){if(typeof n!="string")throw`cf must be a string (hint: if you are using "pki.filters.pkiItalyCodiceFiscaleEquals", try "pki.filters.pkiItalyCodiceFiscaleEquals('someCodice')")`;return function(a){return a.pkiItaly&&a.pkiItaly.codiceFiscale===n}},isWithinValidity:function(n){if(typeof n>"u")throw'filter called without cert argument (hint: if you are using "pki.filters.isWithinValidity()", try "pki.filters.isWithinValidity")';var a=new Date;return n.validityStart<=a&&a<=n.validityEnd},all:function(){var n;return arguments.length===1&&typeof arguments[0]=="object"?n=arguments[0]:n=arguments,function(a){for(var c=0;c<n.length;c++){var b=n[c];if(!b(a))return!1}return!0}},any:function(){var n;return arguments.length===1&&typeof arguments[0]=="object"?n=arguments[0]:n=arguments,function(a){for(var c=0;c<n.length;c++){var b=n[c];if(b(a))return!0}return!1}}},e.readCertificate=function(n){typeof n=="string"&&(n={thumbprint:n});var a=this._createContext(n);return e._requestHandler.sendCommand(a,"readCertificate",{certificateThumbprint:n.thumbprint}),a.promise},e.pollNative=function(n){n||(n={});var a=this._createContext(n),c=n.requiredApiVersion;if(c||(c=e.apiVersions.latest),!e._apiMap.nativeWin[c])throw"Unknown JSlib API version: "+c;return e._requestHandler.sendCommand(a,"pollNative",{requiredNativeWinVersion:e._apiMap.nativeWin[c],requiredNativeLinuxVersion:e._apiMap.nativeLinux[c],requiredNativeMacVersion:e._apiMap.nativeMac[c]}),a.promise},e.signHash=function(n){var a=this._createContext(n),c={certificateThumbprint:n.thumbprint,hash:n.hash,digestAlgorithm:n.digestAlgorithm};return e._requestHandler.sendCommand(a,"signHash",c),a.promise},e.signData=function(n){var a=this._createContext(n),c={certificateThumbprint:n.thumbprint,data:n.data,digestAlgorithm:n.digestAlgorithm};return e._requestHandler.sendCommand(a,"signData",c),a.promise},e.keySignHash=function(n){var a=this._createContext(n),c={privateKeyId:n.privateKeyId,hash:n.hash,digestAlgorithm:n.digestAlgorithm,pkcs11Modules:e._getRequestOsP11Modules(n.pkcs11Modules),tokenSerialNumber:n.tokenSerialNumber};return e._handleP11ModulesArgs(n,c),e._requestHandler.sendCommand(a,"keySignHash",c),a.promise},e.keySignData=function(n){var a=this._createContext(n),c={privateKeyId:n.privateKeyId,data:n.data,digestAlgorithm:n.digestAlgorithm,pkcs11Modules:e._getRequestOsP11Modules(n.pkcs11Modules),tokenSerialNumber:n.tokenSerialNumber};return e._handleP11ModulesArgs(n,c),e._requestHandler.sendCommand(a,"keySignData",c),a.promise},e.signWithRestPki=function(n){var a=this._createContext(n),c={certificateThumbprint:n.thumbprint,token:n.token,restPkiUrl:this.restPkiUrl};return e._requestHandler.sendCommand(a,"signWithRestPki",c),a.promise},e.signHashBatch=function(n){var a=this._createContext(n),c={certificateThumbprint:n.certificateThumbprint,digestAlgorithm:n.digestAlgorithm,usePreauthorizedSignatures:n.usePreauthorizedSignatures,batch:n.batch};return e._requestHandler.sendCommand(a,"signHashBatch",c),a.promise},e.signHashes=function(n){var a=this._createContext(n),c={certificateThumbprint:n.certificateThumbprint,hashes:n.hashes};return e._requestHandler.sendCommand(a,"signHashes",c),a.promise},e.preauthorizeSignatures=function(n){n||(n={});var a=this._createContext(n),c={certificateThumbprint:n.certificateThumbprint,signatureCount:n.signatureCount};return e._requestHandler.sendCommand(a,"preauthorizeSignatures",c),a.promise},e.showFolderBrowser=function(n){n?typeof n=="string"&&(n={message:n}):n={};var a=this._createContext(n),c={message:n.message};return e._requestHandler.sendCommand(a,"showFolderBrowser",c),a.promise},e.showFileBrowser=function(n){n||(n={});var a=this._createContext(n),c={multiselect:n.multiselect,filters:n.filters,dialogTitle:n.dialogTitle};return e._requestHandler.sendCommand(a,"showFileBrowser",c),a.promise},e.downloadToFolder=function(n){n||(n={});var a=n.url||"";if(a.indexOf("://")<0){var c=document.createElement("a");c.href=a,a=c.href}var b=this._createContext(n),E={url:a,folderId:n.folderId,filename:n.filename};return e._requestHandler.sendCommand(b,"downloadToFolder",E),b.promise},e.openFolder=function(n){n?typeof n=="string"&&(n={folderId:n}):n={};var a=this._createContext(n);return e._requestHandler.sendCommand(a,"openFolder",n.folderId),a.promise},e.openFile=function(n){n?typeof n=="string"&&(n={fileId:n}):n={};var a=this._createContext(n);return e._requestHandler.sendCommand(a,"openFile",n.fileId),a.promise},e.redirectToInstallPage=function(){document.location.href=e._installUrl+(this.brand||"")+"?returnUrl="+encodeURIComponent(document.URL)+"&jslib="+e._jslibVersion},e.updateExtension=function(n){n||(n={});var a=this._createContext(n);return e._requestHandler.sendCommand(a,"updateExtension",null),a.promise},e._createCommonSignerRequest=function(n){if(!n.output)throw"An output parameter must be passed to signer methods";return{fileId:n.fileId,content:n.content,certificateThumbprint:n.certificateThumbprint,output:{mode:n.output.mode,folderId:n.output.folderId,dialogTitle:n.output.dialogTitle,fileNameSuffix:n.output.fileNameSuffix},trustArbitrators:n.trustArbitrators,clearPolicyTrustArbitrators:n.clearPolicyTrustArbitrators,certificateValidationLevel:n.certificateValidationLevel,timestampRequester:n.timestampRequester,policy:n.policy}},e.signPdf=function(n){var a=this._createContext(n),c=e._createCommonSignerRequest(n);if(c.visualRepresentation=n.visualRepresentation,c.pdfMarks=n.pdfMarks,c.bypassMarksIfSigned=n.bypassMarksIfSigned,c.reason=n.reason,c.location=n.location,c.signerName=n.signerName,c.customSignatureFieldName=n.customSignatureFieldName,typeof n.metadata=="object"){c.metadata={};for(var b=Object.keys(n.metadata),E=0;E<b.length;E++){var x=b[E];if(typeof n.metadata[x]!="string")throw"Only string values allowed on metadata dictionary. Found type "+typeof n.metadata[x]+": "+x+":"+n.metadata[x];c.metadata[x]=n.metadata[x]}}return c.visualRepresentation&&c.visualRepresentation.image&&c.visualRepresentation.image.resource&&!c.visualRepresentation.image.resource.content&&c.visualRepresentation.image.resource.url&&!/^(https?:)?\/\//.exec(c.visualRepresentation.image.resource.url)?e._downloadResource(c.visualRepresentation.image.resource.url,function(T){c.visualRepresentation.image.resource=T,e._requestHandler.sendCommand(a,"signPdf",c,e._processSignResult)}):e._requestHandler.sendCommand(a,"signPdf",c,e._processSignResult),a.promise},e.signCades=function(n){var a=this._createContext(n),c=e._createCommonSignerRequest(n);return c.cmsToCosignFileId=n.cmsToCosignFileId,c.cmsToCosignContent=n.cmsToCosignContent,c.autoDetectCosign=n.autoDetectCosign,c.includeEncapsulatedContent=n.includeEncapsulatedContent===null||n.includeEncapsulatedContent===void 0?!0:n.includeEncapsulatedContent,c.signingDescription=n.signingDescription,e._requestHandler.sendCommand(a,"signCades",c,e._processSignResult),a.promise},e.signFullXml=function(n){var a=this._createContext(n),c=e._createCommonSignerRequest(n);return c.signerType="fullXml",e._signXmlCommon(n,c,a),a.promise},e.signXmlElement=function(n){var a=this._createContext(n),c=e._createCommonSignerRequest(n);return c.signerType="xmlElement",c.toSignElementId=n.toSignElementId,c.toSignElementsIds=n.toSignElementsIds,c.toSignElementsXPath=n.toSignElementsXPath,c.idResolutionTable=n.idResolutionTable,e._signXmlCommon(n,c,a),a.promise},e._signXmlCommon=function(n,a,c){a.signatureElementId=n.signatureElementId,a.signingDescription=n.signingDescription,n.signatureElementLocation&&(a.signatureElementLocation={xpath:n.signatureElementLocation.xpath,insertionOption:n.signatureElementLocation.insertionOption}),a.namespaces=n.namespaces,e._requestHandler.sendCommand(c,"signXml",a,e._processSignResult)},e._createCommonOpenRequest=function(n){return{signatureFileId:n.signatureFileId,signatureContent:n.signatureContent,validate:n.validate,dateReference:n.dateReference,trustArbitrators:n.trustArbitrators,clearPolicyTrustArbitrators:n.clearPolicyTrustArbitrators,specificPolicy:n.specificPolicy}},e.openPades=function(n){var a=this._createContext(n),c=e._createCommonOpenRequest(n);return e._requestHandler.sendCommand(a,"openPades",c,e._processOpenResult),a.promise},e.openCades=function(n){var a=this._createContext(n),c=e._createCommonOpenRequest(n);return c.originalFileId=n.originalFileId,c.originalContent=n.originalContent,c.acceptablePolicies=n.acceptablePolicies,c.returnEncapsulatedContent=n.returnEncapsulatedContent,e._requestHandler.sendCommand(a,"openCades",c,e._processOpenResult),a.promise},e.openXmlSignature=function(n){var a=this._createContext(n),c=e._createCommonOpenRequest(n);return c.idResolutionTable=n.idResolutionTable,c.acceptablePolicies=n.acceptablePolicies,e._requestHandler.sendCommand(a,"openXmlSignature",c,e._processOpenResult),a.promise},e.listTokens=function(n){var a=this._createContext(n),c={pkcs11Modules:e._getRequestOsP11Modules(n.pkcs11Modules)};return e._requestHandler.sendCommand(a,"listTokens",c),a.promise},e.generateTokenRsaKeyPair=function(n){var a=this._createContext(n),c={pkcs11Modules:e._getRequestOsP11Modules(n.pkcs11Modules),subjectName:n.subjectName,tokenSerialNumber:n.tokenSerialNumber,keyLabel:n.keyLabel,keySize:n.keySize,enableUsedPkcs11Module:n.enableUsedPkcs11Module};return e._handleP11ModulesArgs(n,c),e._requestHandler.sendCommand(a,"generateTokenRsaKeyPair",c),a.promise},e.generateSoftwareRsaKeyPair=function(n){var a=this._createContext(n),c={subjectName:n.subjectName,keySize:n.keySize,nonExportableKey:n.nonExportableKey};return e._requestHandler.sendCommand(a,"generateSoftwareRsaKeyPair",c),a.promise},e.importTokenCertificate=function(n){var a=this._createContext(n),c={privateKeyId:n.privateKeyId,pkcs11Modules:e._getRequestOsP11Modules(n.pkcs11Modules),tokenSerialNumber:n.tokenSerialNumber,certificateContent:n.certificateContent,certificateLabel:n.certificateLabel,enableUsedPkcs11Module:n.enableUsedPkcs11Module};return e._handleP11ModulesArgs(n,c),e._requestHandler.sendCommand(a,"importTokenCertificate",c),a.promise},e.importCertificate=function(n){var a=this._createContext(n),c={privateKeyId:n.privateKeyId,certificateContent:n.certificateContent,passwordPolicies:n.passwordPolicies,passwordMinLength:n.passwordMinLength,savePkcs12:n.savePkcs12};return e._requestHandler.sendCommand(a,"importCertificate",c),a.promise},e.sendAuthenticatedRequest=function(n){var a=this._createContext(n),c={certificateThumbprint:n.certificateThumbprint,method:n.method,headers:n.headers,body:n.body,url:n.url};return e._requestHandler.sendCommand(a,"sendAuthenticatedRequest",c),a.promise},e.getGeolocation=function(n){var a=this._createContext(n),c={certificateThumbprint:n.certificateThumbprint};return e._requestHandler.sendCommand(a,"getGeolocation",c),a.promise},e.encrypt=function(n){var a=typeof n.token=="object"?n.token:null,c=this._createContext(n),b={certificateThumbprint:n.certificateThumbprint,publicKey:n.publicKey,privateKeyId:n.privateKeyId,tokenSerialNumber:a?a.serialNumber:null,pkcs11Module:a?a.pkcs11Module:null,parameters:n.parameters,data:n.data};return e._requestHandler.sendCommand(c,"encrypt",b),c.promise},e.decrypt=function(n){var a=typeof n.token=="object"?n.token:null,c=this._createContext(n),b={certificateThumbprint:n.certificateThumbprint,privateKeyId:n.privateKeyId,tokenSerialNumber:a?a.serialNumber:null,pkcs11Module:a?a.pkcs11Module:null,parameters:n.parameters,data:n.data};return e._requestHandler.sendCommand(c,"decrypt",b),c.promise},e.detectedBrowser=function(){var n=navigator.userAgent,a,c=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(c[1])?(a=/\brv[ :]+(\d+)/g.exec(n)||[],"IE "+(a[1]||"")):c[1]==="Chrome"&&(a=n.match(/\b(OPR|Edge|Edg)\/(\d+)/),a!==null)?a.slice(1).join(" ").replace("OPR","Opera"):(c=c[2]?[c[1],c[2]]:[navigator.appName,navigator.appVersion,"-?"],(a=n.match(/version\/(\d+)/i))!==null&&c.splice(1,1,a[1]),c.join(" "))}(),e._supportedMobileDetected=!1;for(var t=window.navigator.maxTouchPoints>3,i="",s=[{getName:function(){return"Android"},r:/Android/},{getName:function(){return"iOS"},r:/(iPhone|iPad|iPod)/},{getName:function(){return t?"iOS":""},r:/(Mac OS|MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],r=0;r<s.length;r++){var o=s[r];if(o.r.test(window.navigator.userAgent)){i=o.getName();break}}if(e._supportedMobileDetected=e._mobileSupported&&i!=="",e.isSupportedMobile=e._supportedMobileDetected,e._requestHandler===void 0){var l="0.0.0",u=null,d=null,f=null,h=null,m=null,v=null,w=null,g=null,I=null,B=null,L=null,G=null,q=null,te=function(n){if(n||(n=e.apiVersions.v1_3),!e._apiMap.nativeWin[n])throw"Unknown JSlib API version: "+n;d=e._apiMap.nativeWin[n],f=e._apiMap.nativeLinux[n],h=e._apiMap.nativeMac[n],m=e._apiMap.ieAddon[n],l=e._apiMap.extension[n],v=e._apiMap.mobile[n],g&&(u=e._chromeExtensionFirstVersionWithSelfUpdate)};if(w=e.detectedBrowser.indexOf("IE")>=0,g=e.detectedBrowser.indexOf("Chrome")>=0,I=e.detectedBrowser.indexOf("Firefox")>=0,B=e.detectedBrowser.indexOf("Edg")>=0,L=e.detectedBrowser.indexOf("Safari")>=0,G=e._supportedMobileDetected&&i==="Android",q=e._supportedMobileDetected&&i==="iOS",!e._supportedMobileDetected&&!w)e._requestHandler=new function(){var n="com.lacunasoftware.WebPKI.RequestEvent",a="com.lacunasoftware.WebPKI.ResponseEvent",c={};B&&e._buildChannel!=="stable"&&(n="com.lacunasoftware.WebPKI.RequestEvent",a="com.lacunasoftware.WebPKI.ResponseEvent");var b=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},E=function(){return b()+b()+"-"+b()+"-"+b()+"-"+b()+"-"+b()+b()+b()},x=function(_,y){var S=E();return c[S]={promise:_,responseProcessor:y},S},T=function(_,y,S,K){var J=x(_.promise,K),ie={requestId:J,license:_.license,useDomainNativePool:_.useDomainNativePool,command:y,request:S};if(g||B){var le=new CustomEvent(n,{detail:ie});document.dispatchEvent(le)}else window.postMessage({port:n,message:ie},"*")},k=function(_,y){te(y),setTimeout(function(){N(_,25)},200)},N=function(_,y){e._log("polling extension");var S=document.getElementById(e._chromeExtensionId)||document.getElementById(e._firefoxExtensionId.replace(/[^A-Za-z0-9_]/g,"_"))||document.getElementById(e._edgeExtensionId)||document.getElementById(e._edgeLegacyProductId);if(S===null){y>1?setTimeout(function(){N(_,y-1)},200):_.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.NOT_INSTALLED,message:"The Web PKI extension is not installed",browserSpecificStatus:e._chromeInstallationStates.EXTENSION_NOT_INSTALLED});return}A(_)},A=function(_){e._log("checking extension version");var y=new e.Promise(null);y.success(function(S){if(e._compareVersions(S,l)<0){var K=u!==null&&e._compareVersions(S,u)>=0;_.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.OUTDATED,browserSpecificStatus:e._chromeInstallationStates.EXTENSION_OUTDATED,message:"The Web PKI extension is outdated (installed version: "+S+", required version: "+l+")",chromeExtensionCanSelfUpdate:K})}else C(_)}),y.fail(function(S){_.promise._invokeError(S)}),T({license:_.license,useDomainNativePool:_.useDomainNativePool,promise:y},"getExtensionVersion",null)},C=function(_){e._log("initializing extension");var y=new e.Promise(null);y.success(function(S){S.isReady?(e._nativeInfo=S.nativeInfo,S.nativeInfo.os==="Windows"&&e._compareVersions(S.nativeInfo.installedVersion,d)<0?_.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.OUTDATED,browserSpecificStatus:e._chromeInstallationStates.NATIVE_OUTDATED,message:"The Web PKI native component is outdated (installed version: "+S.nativeInfo.installedVersion+", required version: "+d+")",platformInfo:S.platformInfo,nativeInfo:S.nativeInfo}):S.nativeInfo.os==="Linux"&&e._compareVersions(S.nativeInfo.installedVersion,f)<0?_.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.OUTDATED,browserSpecificStatus:e._chromeInstallationStates.NATIVE_OUTDATED,message:"The Web PKI native component is outdated (installed version: "+S.nativeInfo.installedVersion+", required version: "+f+")",platformInfo:S.platformInfo,nativeInfo:S.nativeInfo}):S.nativeInfo.os==="Darwin"&&e._compareVersions(S.nativeInfo.installedVersion,h)<0?_.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.OUTDATED,browserSpecificStatus:e._chromeInstallationStates.NATIVE_OUTDATED,message:"The Web PKI native component is outdated (installed version: "+S.nativeInfo.installedVersion+", required version: "+h+")",platformInfo:S.platformInfo,nativeInfo:S.nativeInfo}):_.promise._invokeSuccess({isInstalled:!0})):_.promise._invokeSuccess({isInstalled:!1,status:V(S.status),browserSpecificStatus:S.status,message:S.message,platformInfo:S.platformInfo,nativeInfo:S.nativeInfo})}),y.fail(function(S){_.promise._invokeError(S)}),T({license:_.license,useDomainNativePool:_.useDomainNativePool,promise:y},"initialize",null)},V=function(_){return _===e._chromeInstallationStates.INSTALLED?e.installationStates.INSTALLED:_===e._chromeInstallationStates.EXTENSION_OUTDATED||_===e._chromeInstallationStates.NATIVE_OUTDATED?e.installationStates.OUTDATED:e.installationStates.NOT_INSTALLED},D=function(_){var y=c[_.requestId];delete c[_.requestId],_.success?(y.responseProcessor&&(_.response=y.responseProcessor(_.response)),y.promise._invokeSuccess(_.response)):y.promise._invokeError(_.exception)};this.sendCommand=T,this.checkInstalled=k,g||B?document.addEventListener(a,function(_){D(_.detail)}):window.addEventListener("message",function(_){_&&_.data&&_.data.port===a&&D(_.data.message)})};else if(w)e._requestHandler=new function(){var n={},a=0,c=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},b=function(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()},E=function(C,V){var D=b();return n[D]={promise:C,pollStart:a,responseProcessor:V},D},x=function(){return window.lacunaWebPKIExtension},T=function(){if(x()){var C=x().GetAvailableResults();if(C===null)throw"Add-on method GetAvailableResults failed";var V=JSON.parse(C),D=[];for(var _ in n)if(n.hasOwnProperty(_)){var y=n[_],S=!1;if(y.sendFailed)S=!0;else{for(var K=null,J=0;J<V.length;J++)if(V[J].requestId==_){K=V[J];break}K!==null?(K.success?(y.responseProcessor&&(K.response=y.responseProcessor(K.response)),y.promise._invokeSuccess(K.response)):y.promise._invokeError(K.exception),S=!0):a>=y.pollStart+120&&(y.promise._invokeError({message:"The operation has timed out",complete:"The operation has timed out",origin:"helper",code:"addon_timeout"}),S=!0)}S&&D.push(_)}for(var ie=0;ie<D.length;ie++)delete n[D[ie]];a+=1}setTimeout(T,500)},k=function(C,V){if(e._log("checking extension"),x()===null){V>1?setTimeout(function(){k(C,V-1)},200):C.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.NOT_INSTALLED,message:"The Web PKI add-on is not installed"});return}var D=new e.Promise(null);D.success(function(_){e._nativeInfo={os:"Windows",installedVersion:_},e._compareVersions(_,m)<0?C.promise._invokeSuccess({isInstalled:!1,status:e.installationStates.OUTDATED,message:"The Web PKI add-on is outdated (installed version: "+_+", latest version: "+m+")"}):C.promise._invokeSuccess({isInstalled:!0})}),D.fail(function(_){C.promise._invokeError(_)}),N({license:C.license,useDomainNativePool:C.useDomainNativePool,promise:D},"getVersion",null)},N=function(C,V,D,_){if(x()){var y=E(C.promise,_),S={requestId:y,license:C.license,useDomainNativePool:C.useDomainNativePool,command:V,request:D},K;try{var J=x().SendCommand(JSON.stringify(S));J===!1&&(K="Failed to send command to add-on")}catch(ie){K="Exception when sending command to add-on: "+ie}K&&(C.promise._invokeError({message:"Failed to send command to add-on",complete:K,origin:"helper",code:"addon_send_command_failure"},200),n[y].sendFailed=!0)}else C.promise._invokeError({message:"Add-on not detected",complete:"Add-on not detected",origin:"helper",code:"addon_not_detected"},200)},A=function(C,V){te(V),setTimeout(function(){k(C,25)},200)};this.sendCommand=N,this.checkInstalled=A,T()};else{var _e=function(){return window.lacunaWebPkiAppBridge},X=null,Q=null,ne=!1;e._requestHandler=new function(){var n=function(c,b,E,x){if(X===null&&W(c),X!==null){X.sendCommand(c,b,E,x);return}var T=setInterval(function(){if(X!==null){clearInterval(T),X.sendCommand(c,b,E,x);return}},400)},a=function(c,b){if(X===null&&W(c),X!==null){X.checkInstalled(c,b);return}var E=setInterval(function(){if(X!==null){clearInterval(E),X.checkInstalled(c,b);return}},400)};this.sendCommand=n,this.checkInstalled=a};var ae=function(){console.log("use mobile in-app integration"),X=new function(){var n={};_e().processResponse=function(T){console.log("Response received: ",T);var k=T;typeof T=="string"&&(k=JSON.parse(T));var N=n[k.requestId];delete n[k.requestId],N&&(k.success?(N.responseProcessor&&(k.response=N.responseProcessor(k.response)),N.promise._invokeSuccess(k.response)):N.promise._invokeError(k.exception))};var a=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},c=function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},b=function(T,k){var N=c();return n[N]={promise:T,responseProcessor:k},N},E=function(T,k,N,A){var C=b(T.promise,A),V={requestId:C,license:T.license,command:k,request:N},D=JSON.stringify(V);console.log("Sending message: "+D),_e().processRequest(D)},x=function(T,k){te(k);var N=new e.Promise(null);N.success(function(A){e._nativeInfo={os:A.os,installedVersion:A.version};var C=e.installationStates.INSTALLED;e._compareVersions(A.version,v)<0&&(C=e.installationStates.OUTDATED),T.promise._invokeSuccess({nativeInfo:{os:A.os,installedVersion:A.version},isInstalled:C===e.installationStates.INSTALLED,status:C})}).fail(function(A){T.promise._invokeError(A)}),E({license:T.license,useDomainNativePool:T.useDomainNativePool,promise:N},"getInfo",null)};this.sendCommand=E,this.checkInstalled=x}},R=function(){console.log("use mobile signalr integration");var n=null,a="https://cloud.lacunasoftware.com/scripts/signalr-client-1.0.4.min.js",c="https://cloud.lacunasoftware.com/js/forge-cipher.min.js",b={require:"require",window:"window"},E=null;if(typeof Ee!="object"&&typeof Me=="function"&&typeof define=="function"&&define.amd)Me([a],function(A){e._signalR=A}),Me([c],function(A){e._forge=A}),E=b.require;else{var x=document.createElement("script");x.setAttribute("src",a),document.getElementsByTagName("head")[0].appendChild(x),x=document.createElement("script"),x.setAttribute("src",c),document.getElementsByTagName("head")[0].appendChild(x),E=b.window}X=new function(){var A=[],C="https://cloud.lacunasoftware.com/",V=C+"api/sessions/",D=C+"session/",_=null,y=!1,S=null,K=!1,J=3,ie=5e3,le=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},zt=function(){A=[],_=null,K=!1},Gt=function(){return le()+le()+"-"+le()+"-"+le()+"-"+le()+"-"+le()+le()+le()},Oe=function(){A.shift(),Fe()},Fe=function(){if(A.length>0){var p=A[0];p.time=new Date().getTime(),p.sendAttempt++,console.log("[Signal] resending request (attempt "+p.sendAttempt+"): "+p.requestId),dt(V+_+"/request",p.data,function(M){(!M||!M.sentToDevice)&&p.sendAttempt>=J&&(p.promise._invokeError({message:"Could not send message to mobile",code:e.errorCodes.MOBILE_SEND_MESSAGE}),Oe())},function(M,z){p.sendAttempt>=J&&(p.promise._invokeError({message:"Error while sending message to mobile: "+M,complete:typeof z=="string"?z:JSON.stringify(z),code:e.errorCodes.MOBILE_SEND_MESSAGE}),Oe())}),p.sendAttempt<=1&&ot(p)}},rt=function(p){p.promise._invokeError({message:"The mobile is not responding",complete:"The operation has timed out",origin:"jslib",code:e.errorCodes.MOBILE_TIMEOUT}),Oe()},ot=function(p){if(!at(p.requestId)){console.log("[Signal] stop request timeout (shift): "+p.requestId);return}var M=new Date().getTime();if(p.receipt){if(M>p.time+6e4){rt(p),console.log("[Signal] stop request timeout (long timeout): "+p.requestId);return}}else if(M>p.time+ie)if(p.sendAttempt<J)Fe();else{rt(p),console.log("[Signal] stop request timeout (short timeout): "+p.requestId);return}setTimeout(function(){ot(p)},1e3)},at=function(p){return A.length!==0&&A[0].requestId===p},lt=function(p){return at(p)?A[0]:null},Yt=function(p){var M=lt(p);M!==null?(M.receipt=!0,console.log("[Signal] got receipt for request: "+p)):console.log("[Signal] disposed! Got receipt for DISPOSED request: "+p)},ct=function(p,M,z,H){if(_==null)throw"The component is not initialized. Make sure the init method was called.";var F={requestId:Gt(),license:p.license,useDomainNativePool:p.useDomainNativePool,command:M,request:z,domain:window.location.hostname},U=F?k(JSON.stringify(F),S):null,Z={type:"request",id:F.requestId,content:U};A.push({requestId:F.requestId,promise:p.promise,responseProcessor:H,data:Z,receipt:!1,sendAttempt:0}),A.length<=1&&Fe()},Xt=function(p,M){zt(),te(M),ut(p)},ut=function(p,M){if(M=M||1,y){Jt(p);return}if(M>50){p.promise._invokeError({message:"Dependency scripts did not load",complete:"Dependency scripts did not load",code:e.errorCodes.UNDEFINED});return}setTimeout(function(){ut(p,M+1)},200)},Jt=function(p){var M=null,z=function(F){n.hide();try{F.stop()}catch(U){console.log("[Signal] error while stopping signalR",U)}},H=function(F,U){if(U=U||1,!K){console.log("[Signal] waiting device connection");var Z=7;if(q&&(Z=5),U>Z){z(F),p.instance.redirectToInstallPage();return}setTimeout(function(){H(F,U+1)},2e3)}};pt(D,function(F){F.on("connected",function(U){K=!0,n.hide(),console.log("[Signal] device connected");var Z=new e.Promise(null);Z.success(function(pe){var Se=e.installationStates.INSTALLED;e._compareVersions(pe.version,v)<0&&(Se=e.installationStates.OUTDATED),p.promise._invokeSuccess({nativeInfo:{os:pe.os,installedVersion:pe.version},isInstalled:Se===e.installationStates.INSTALLED,status:Se})}).fail(function(pe){p.promise._invokeError(pe)}),console.log("[Signal] sending first command"),ct({license:p.license,useDomainNativePool:p.useDomainNativePool,promise:Z},"getInfo",null)}),F.on("message",function(U){console.log("[Signal] available response"),Qt(V+_+"/response",Zt)}),F.on("connectionId",function(U){console.log("[Signal] Got connection id: "+U),M=U}),F.on("receipt",function(U){Yt(U)}),F.onclose(function(U){console.log("[Signal] disconnected",U)})}).then(function(F){var U=function(Z){if(console.log("[Signal] Getting connection Id"),Z=Z||1,Z>10){console.log("[Signal] Fail. ConnectionId timeout"),p.promise._invokeError({message:"Connection Id timeout",complete:"Did not get connection Id event.",code:e.errorCodes.UNDEFINED});return}if(!M){setTimeout(function(){U(Z+1)},1e3);return}console.log("[Signal] Getting session");var pe={connectionId:M};dt(V,pe,function(Se){_=Se.sessionId,S=T(),console.log("[Signal] session started"),console.log("[Signal] showing modal deep link");var ft="start?s="+_+"&k="+S.hex+"&b="+e.detectedBrowser+"&o="+window.location.hostname,mt="webpki://"+ft;G&&(mt="intent://"+ft+"#Intent;scheme=webpki;S.browser_fallback_url="+encodeURIComponent(e._installUrl+(p.instance.brand||"")+"?returnUrl="+encodeURIComponent(document.URL)+"&jslib="+e._jslibVersion)+";end"),n=new Q(mt),n.onOkCLick=function(){n.showWait(),H(F)},n.onCancelClick=function(){z(F),p.promise._invokeError({message:"Start mobile app cancelled",complete:"Start mobile app cancelled",code:e.errorCodes.USER_CANCELLED})},n.show()})};setTimeout(U,100)})},Zt=function(p){p=typeof p=="string"?JSON.parse(p):p,console.log("[Signal] got response. Type: "+p.type);var M={};try{if(p.format!=0)throw{message:"Unknown data format: "+p.format};p.type!=="Error"?M=JSON.parse(N(p.content,S)):M={requestId:p.id,success:!1,exception:p.content?typeof p.content=="string"?JSON.parse(p.content):p.content:{message:"Cryptographic error on mobile native",error:"Cryptographic error on mobile native",code:e.errorCodes.COMMAND_DECRYPT_ERROR}}}catch(H){M={requestId:p.id,success:!1,exception:{message:"Error while decrypting response message",error:typeof H=="object"?H.message||JSON.stringify(H):H,code:e.errorCodes.COMMAND_DECRYPT_ERROR}}}var z=lt(p.id);if(z===null){console.log("[Signal] got response for disposed request: "+p.id);return}M.success?(z.responseProcessor&&(M.response=z.responseProcessor(M.response)),z.promise._invokeSuccess(M.response)):z.promise._invokeError(M.exception),Oe()},Qt=function(p,M,z){var H=new XMLHttpRequest;H.onreadystatechange=function(){ht(H,"GET",p,M,z)},H.open("GET",p,!0),H.setRequestHeader("Accept","application/json"),H.withCredentials=!1,console.log("[HttpHandler] Get "+p),H.send()},dt=function(p,M,z,H){var F=new XMLHttpRequest;F.onreadystatechange=function(){ht(F,"POST",p,z,H)},F.open("POST",p,!0),F.setRequestHeader("Content-Type","application/json"),F.setRequestHeader("Accept","application/json"),F.withCredentials=!1,console.log("[HttpHandler] Post on ("+p+"): ",M),F.send(JSON.stringify(M))},ht=function(p,M,z,H,F){if(p.readyState===4)if(p.status>=200&&p.status<=299){var U=null;if(p.status===200||p.status===201)try{U=JSON.parse(p.responseText),H(U)}catch{console.log("[HttpHandler] error parsing response."),U=p.responseText,F(p.status,U)}console.log("[HttpHandler] received response from "+M+" "+z,U)}else if(p.status===0&&!p.responseText&&q)console.log("[HttpHandler] got Safari abort connection. Applying workaround"),H({sentToDevice:!0});else{var Z;try{Z=JSON.parse(p.responseText)}catch{console.log("[HttpHandler] error parsing error"),Z=null}console.log("[HttpHandler] error: "+p.responseText),F(p.status,Z)}},pt=null;(function(){var p=function(M){if(M=M||1,M>100)throw"Script "+(!e._forge&&!e._signalR?"forge / signalR":e._forge?"signalR":"forge")+" did not load";E!==b.require&&(e._signalR=window.signalR,e._forge=window.forge),e._signalR!==void 0&&e._forge!==void 0?(pt=function(z,H){return function(){console.log("[Signal] Starting connection");var U=new e._signalR.HubConnectionBuilder().withUrl(z).build();return H&&typeof H=="function"&&H(U),U.start().then(function(){return U}).catch(function(Z){return console.log("[Signal] Cannot start the connection. Erro: ",Z),window.Promise.reject(Z)})}()},y=!0):setTimeout(function(){p(M+1)},200)};setTimeout(function(){p()},50)})(),this.sendCommand=ct,this.checkInstalled=Xt};var T=function(){var A=e._forge.random.getBytesSync(32);return{raw:A,b64:e._forge.util.encode64(A),hex:e._forge.util.bytesToHex(A)}},k=function(A,C){var V=e._forge.random.getBytesSync(16),D=C.raw,_=new e._forge.util.ByteBuffer;_.putBuffer(e._forge.util.createBuffer(A));var y=e._forge.cipher.createCipher("AES-CBC",D);y.start({iv:V}),y.update(_),y.finish();var S=y.output.bytes(),K=e._forge.hmac.create();K.start("sha256",D),K.update(S),hmacContent=K.digest().bytes();var J=new e._forge.util.ByteBuffer;return J.putBytes(V),J.putBytes(hmacContent),J.putBytes(S),e._forge.util.encode64(J.bytes())},N=function(A,C){var V=C.raw,D=new e._forge.util.ByteBuffer;D.putBytes(e._forge.util.decode64(A));var _=D.getBytes(16),y=D.getBytes(32),S=D.bytes(),K=e._forge.hmac.create();K.start("sha256",V),K.update(S);var J=K.digest().bytes();if(J!==y)throw{message:"Error on message integrity"};var ie=e._forge.cipher.createDecipher("AES-CBC",V);ie.start({iv:_}),ie.update(D);var le=ie.finish();if(!le)throw{message:"Error on message decryption"};return e._forge.util.decodeUtf8(ie.output.getBytes())}},j=function(n){X=new function(){var a="-lcn",c="wpki"+a,b="access?u="+encodeURIComponent(window.location.href)+"&c="+encodeURIComponent(document.cookie),E=c+"://"+b;G&&(E="intent://"+b+"#Intent;scheme="+c+";S.browser_fallback_url="+encodeURIComponent(e._installUrl+(n.instance.brand||"")+"?returnUrl="+encodeURIComponent(document.URL)+"&jslib="+e._jslibVersion)+";end"),this.sendCommand=function(x,T,k,N){},this.checkInstalled=function(x,T){var k=new Q(E);k.onOkCLick=function(){k.showWait();var N=new Date;setTimeout(function(){k.hide(),q&&new Date-N<10*1e3&&x.instance.redirectToInstallPage()},5e3)},k.onCancelClick=function(){k.hide(),x.promise._invokeError({message:"Start mobile app cancelled",complete:"Start mobile app cancelled",code:e.errorCodes.USER_CANCELLED})},k.show()}}},W=function(n){if(!ne){ne=!0;var a=10,c=setInterval(function(){if(console.log("polling mobile integration mode ..."),a<=0){clearInterval(c),n.instance.mobileIntegrationMode===e.mobileIntegrationModes.browserIntegration?R():j(n);return}if(_e()&&_e().loaded){clearInterval(c),ae();return}a--},300)}};Q=function(n){this.deepLink=n,this.onOkCLick=null,this.onCancelClick=null;var a=null,c={pt:{accessCertificates:"O site {{domain}} deseja acessar seus certificados digitais.",authorize:"Permitir",cancel:"Cancelar",wait:"Aguarde..."},en:{accessCertificates:"The website {{domain}} wants to access your digital certificates.",authorize:"Authorize",cancel:"Cancel",wait:"Please wait..."},es:{accessCertificates:"El sitio {{domain}} quiere acceder a sus certificados digitales.",authorize:"Permitir",cancel:"Cancelar",wait:"Espera..."}},b=null,E=function(T){if(b===null){var k=window.navigator.language||"en",N=Object.keys(c);b=N.indexOf(k)>-1?k:k.length>1&&N.indexOf(k.substring(0,2))>-1?k.substring(0,2):"en"}return c[b][T]||T},x=function(T){a=document.getElementById("webPkiModal"),a!=null&&(a.removeChild(a.firstChild),document.getElementsByTagName("body")[0].removeChild(a)),a=document.createElement("div"),a.setAttribute("id","webPkiModal"),a.setAttribute("style","display: none;");var k=document.createElement("div");k.setAttribute("style",'display: table; background-color: #fefefe; margin: 5%; width: 90%; height: 90%; font-family: "Helvetica"; text-align: center; border-radius: 10px;');var N=document.createElement("div");N.setAttribute("style","display: table-cell; vertical-align: middle;");var A=document.createElement("p");A.setAttribute("id","webPkiWaitElement"),A.setAttribute("style","display: none"),A.appendChild(document.createTextNode(E("wait")));var C=document.createElement("p");C.setAttribute("id","webPkiTextElement"),C.setAttribute("style","padding-left: 5%; padding-right: 5%; font-size: 1.6em; color: black; word-wrap: break-word; white-space: normal;"),C.appendChild(document.createTextNode(E("accessCertificates").split("{{domain}}")[0]));var V=document.createElement("strong");V.appendChild(document.createTextNode(window.location.hostname)),C.appendChild(V),C.appendChild(document.createTextNode(E("accessCertificates").split("{{domain}}")[1]));var D=document.createElement("div");D.setAttribute("id","webPkiButtonsElement");var _=document.createElement("a");_.setAttribute("style","-webkit-appearance: button; -moz-appearance: button; appearance: button; padding: 2% 4%; text-align: center; text-decoration: none; display: inline-block; font-size: 1.1em; margin: 5%; cursor: pointer; background-color: #e7e7e7; color: black"),_.appendChild(document.createTextNode(E("cancel")));var y=document.createElement("a");y.setAttribute("style","-webkit-appearance: button; -moz-appearance: button; appearance: button; padding: 2% 4%; text-align: center; text-decoration: none; display: inline-block; font-size: 1.1em; margin: 5%; cursor: pointer; background-color: #0078e7; color: white"),y.setAttribute("id","wpkiModalDeepLink"),y.setAttribute("href",T.deepLink),y.appendChild(document.createTextNode(E("authorize"))),q?(D.appendChild(_),D.appendChild(y)):(D.appendChild(y),D.appendChild(_)),N.appendChild(A),N.appendChild(C),N.appendChild(D),k.appendChild(N),a.appendChild(k),document.getElementsByTagName("body")[0].appendChild(a),y.onclick=T.onOkCLick,_.onclick=T.onCancelClick};this.hide=function(){a.setAttribute("style","display: none;")},this.show=function(){x(this),a.setAttribute("style","display: block; position: fixed; z-index: 100000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgb(0,0,0); background-color: rgba(0,0,0,0.4);")},this.showWait=function(){document.getElementById("webPkiTextElement").setAttribute("style","display: none;"),document.getElementById("webPkiButtonsElement").setAttribute("style","display: none;"),document.getElementById("webPkiWaitElement").setAttribute("style","padding-left: 5%; padding-right: 5%; font-size: 1.6em; color: black; word-wrap: break-word;")}}}}})(LacunaWebPKI.prototype);typeof Ee=="object"&&(Object.defineProperties?Object.defineProperties(Ee,{default:{value:LacunaWebPKI},__esModule:{value:!0},LacunaWebPKI:{value:LacunaWebPKI}}):(Ee.default=LacunaWebPKI,Ee.__esModule=!0,Ee.LacunaWebPKI=LacunaWebPKI))});var qe=function(e,t){return qe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(i[r]=s[r])},qe(e,t)};function Dt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");qe(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var re=function(){return re=Object.assign||function(t){for(var i,s=1,r=arguments.length;s<r;s++){i=arguments[s];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t},re.apply(this,arguments)};function ai(e,t,i){if(i||arguments.length===2)for(var s=0,r=t.length,o;s<r;s++)(o||!(s in t))&&(o||(o=Array.prototype.slice.call(t,0,s)),o[s]=t[s]);return e.concat(o||Array.prototype.slice.call(t))}var Y={ADD_CHOICE:"ADD_CHOICE",REMOVE_CHOICE:"REMOVE_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM"},se={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},$={TAB_KEY:9,SHIFT_KEY:16,BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},li=["fuseOptions","classNames"],ve={Text:"text",SelectOne:"select-one",SelectMultiple:"select-multiple"},ci=function(e){return{type:Y.ADD_CHOICE,choice:e}},vt=function(e){return{type:Y.REMOVE_CHOICE,choice:e}},ui=function(e){return{type:Y.FILTER_CHOICES,results:e}},di=function(e){return{type:Y.ACTIVATE_CHOICES,active:e}},hi=function(e){return{type:Y.ADD_GROUP,group:e}},pi=function(e){return{type:Y.ADD_ITEM,item:e}},gt=function(e){return{type:Y.REMOVE_ITEM,item:e}},Pe=function(e,t){return{type:Y.HIGHLIGHT_ITEM,item:e,highlighted:t}},fi=function(e,t){return Math.floor(Math.random()*(t-e)+e)},bt=function(e){return Array.from({length:e},function(){return fi(0,36).toString(36)}).join("")},mi=function(e,t){var i=e.id||e.name&&"".concat(e.name,"-").concat(bt(2))||bt(4);return i=i.replace(/(:|\.|\[|\]|,)/g,""),i="".concat(t,"-").concat(i),i},_i=function(e,t,i){i===void 0&&(i=1);for(var s="".concat(i>0?"next":"previous","ElementSibling"),r=e[s];r;){if(r.matches(t))return r;r=r[s]}return null},vi=function(e,t,i){i===void 0&&(i=1);var s;return i>0?s=t.scrollTop+t.offsetHeight>=e.offsetTop+e.offsetHeight:s=e.offsetTop>=t.scrollTop,s},Ve=function(e){if(typeof e!="string"){if(e==null)return"";if(typeof e=="object"){if("raw"in e)return Ve(e.raw);if("trusted"in e)return e.trusted}return e}return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;")},gi=function(){var e=document.createElement("div");return function(t){e.innerHTML=t.trim();for(var i=e.children[0];e.firstChild;)e.removeChild(e.firstChild);return i}}(),Te=function(e,t){return typeof e=="function"?e(Ve(t),t):e},yt=function(e){return typeof e=="function"?e():e},ye=function(e){if(typeof e=="string")return e;if(typeof e=="object"){if("trusted"in e)return e.trusted;if("raw"in e)return e.raw}return""},bi=function(e){if(typeof e=="string")return e;if(typeof e=="object"){if("escaped"in e)return e.escaped;if("trusted"in e)return e.trusted}return""},st=function(e,t){return e?bi(t):Ve(t)},fe=function(e,t,i){e.innerHTML=st(t,i)},yi=function(e,t){var i=e.value,s=e.label,r=s===void 0?i:s,o=t.value,l=t.label,u=l===void 0?o:l;return ye(r).localeCompare(ye(u),[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})},Ei=function(e,t){return e.rank-t.rank},Ii=function(e,t,i){i===void 0&&(i=null);var s=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0});return e.dispatchEvent(s)},Si=function(e,t){var i=Object.keys(e).sort(),s=Object.keys(t).sort();return i.filter(function(r){return s.indexOf(r)<0})},Be=function(e){return Array.isArray(e)?e:[e]},Ce=function(e){return e&&Array.isArray(e)?e.map(function(t){return".".concat(t)}).join(""):".".concat(e)},P=function(e,t){var i;(i=e.classList).add.apply(i,Be(t))},ue=function(e,t){var i;(i=e.classList).remove.apply(i,Be(t))},Ci=function(e){if(typeof e<"u")try{return JSON.parse(e)}catch{return e}return{}},wi=function(e,t,i){var s=e.itemEl;s&&(ue(s,i),P(s,t))},Ai=function(){function e(t){var i=t.element,s=t.type,r=t.classNames;this.element=i,this.classNames=r,this.type=s,this.isActive=!1}return e.prototype.show=function(){return P(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},e.prototype.hide=function(){return ue(this.element,this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},e}(),Et=function(){function e(t){var i=t.element,s=t.type,r=t.classNames,o=t.position;this.element=i,this.classNames=r,this.type=s,this.position=o,this.isOpen=!1,this.isFlipped=!1,this.isDisabled=!1,this.isLoading=!1}return e.prototype.shouldFlip=function(t,i){var s=!1;return this.position==="auto"?s=this.element.getBoundingClientRect().top-i>=0&&!window.matchMedia("(min-height: ".concat(t+1,"px)")).matches:this.position==="top"&&(s=!0),s},e.prototype.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},e.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},e.prototype.open=function(t,i){P(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(t,i)&&(P(this.element,this.classNames.flippedState),this.isFlipped=!0)},e.prototype.close=function(){ue(this.element,this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(ue(this.element,this.classNames.flippedState),this.isFlipped=!1)},e.prototype.addFocusState=function(){P(this.element,this.classNames.focusState)},e.prototype.removeFocusState=function(){ue(this.element,this.classNames.focusState)},e.prototype.enable=function(){ue(this.element,this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===ve.SelectOne&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},e.prototype.disable=function(){P(this.element,this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===ve.SelectOne&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},e.prototype.wrap=function(t){var i=this.element,s=t.parentNode;s&&(t.nextSibling?s.insertBefore(i,t.nextSibling):s.appendChild(i)),i.appendChild(t)},e.prototype.unwrap=function(t){var i=this.element,s=i.parentNode;s&&(s.insertBefore(t,i),s.removeChild(i))},e.prototype.addLoadingState=function(){P(this.element,this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},e.prototype.removeLoadingState=function(){ue(this.element,this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},e}(),Ti=function(){function e(t){var i=t.element,s=t.type,r=t.classNames,o=t.preventPaste;this.element=i,this.type=s,this.classNames=r,this.preventPaste=o,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=i.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(e.prototype,"placeholder",{set:function(t){this.element.placeholder=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.value},set:function(t){this.element.value=t},enumerable:!1,configurable:!0}),e.prototype.addEventListeners=function(){var t=this.element;t.addEventListener("paste",this._onPaste),t.addEventListener("input",this._onInput,{passive:!0}),t.addEventListener("focus",this._onFocus,{passive:!0}),t.addEventListener("blur",this._onBlur,{passive:!0})},e.prototype.removeEventListeners=function(){var t=this.element;t.removeEventListener("input",this._onInput),t.removeEventListener("paste",this._onPaste),t.removeEventListener("focus",this._onFocus),t.removeEventListener("blur",this._onBlur)},e.prototype.enable=function(){var t=this.element;t.removeAttribute("disabled"),this.isDisabled=!1},e.prototype.disable=function(){var t=this.element;t.setAttribute("disabled",""),this.isDisabled=!0},e.prototype.focus=function(){this.isFocussed||this.element.focus()},e.prototype.blur=function(){this.isFocussed&&this.element.blur()},e.prototype.clear=function(t){return t===void 0&&(t=!0),this.element.value="",t&&this.setWidth(),this},e.prototype.setWidth=function(){var t=this.element;t.style.minWidth="".concat(t.placeholder.length+1,"ch"),t.style.width="".concat(t.value.length+1,"ch")},e.prototype.setActiveDescendant=function(t){this.element.setAttribute("aria-activedescendant",t)},e.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},e.prototype._onInput=function(){this.type!==ve.SelectOne&&this.setWidth()},e.prototype._onPaste=function(t){this.preventPaste&&t.preventDefault()},e.prototype._onFocus=function(){this.isFocussed=!0},e.prototype._onBlur=function(){this.isFocussed=!1},e}(),ki=4,It=function(){function e(t){var i=t.element;this.element=i,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return e.prototype.prepend=function(t){var i=this.element.firstElementChild;i?this.element.insertBefore(t,i):this.element.append(t)},e.prototype.scrollToTop=function(){this.element.scrollTop=0},e.prototype.scrollToChildElement=function(t,i){var s=this;if(t){var r=this.element.offsetHeight,o=this.element.scrollTop+r,l=t.offsetHeight,u=t.offsetTop+l,d=i>0?this.element.scrollTop+u-o:t.offsetTop;requestAnimationFrame(function(){s._animateScroll(d,i)})}},e.prototype._scrollDown=function(t,i,s){var r=(s-t)/i,o=r>1?r:1;this.element.scrollTop=t+o},e.prototype._scrollUp=function(t,i,s){var r=(t-s)/i,o=r>1?r:1;this.element.scrollTop=t-o},e.prototype._animateScroll=function(t,i){var s=this,r=ki,o=this.element.scrollTop,l=!1;i>0?(this._scrollDown(o,r,t),o<t&&(l=!0)):(this._scrollUp(o,r,t),o>t&&(l=!0)),l&&requestAnimationFrame(function(){s._animateScroll(t,i)})},e}(),xt=function(){function e(t){var i=t.element,s=t.classNames;this.element=i,this.classNames=s,this.isDisabled=!1}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.element.value},set:function(t){this.element.setAttribute("value",t),this.element.value=t},enumerable:!1,configurable:!0}),e.prototype.conceal=function(){var t=this.element;P(t,this.classNames.input),t.hidden=!0,t.tabIndex=-1;var i=t.getAttribute("style");i&&t.setAttribute("data-choice-orig-style",i),t.setAttribute("data-choice","active")},e.prototype.reveal=function(){var t=this.element;ue(t,this.classNames.input),t.hidden=!1,t.removeAttribute("tabindex");var i=t.getAttribute("data-choice-orig-style");i?(t.removeAttribute("data-choice-orig-style"),t.setAttribute("style",i)):t.removeAttribute("style"),t.removeAttribute("data-choice")},e.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},e.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},e.prototype.triggerEvent=function(t,i){Ii(this.element,t,i||{})},e}(),Oi=function(e){Dt(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(xt),Ae=function(e,t){return t===void 0&&(t=!0),typeof e>"u"?t:!!e},Lt=function(e){if(typeof e=="string"&&(e=e.split(" ").filter(function(t){return t.length})),Array.isArray(e)&&e.length)return e},ce=function(e,t,i){if(i===void 0&&(i=!0),typeof e=="string"){var s=Ve(e),r=i||s===e?e:{escaped:s,raw:e},o=ce({value:e,label:r,selected:!0},!1);return o}var l=e;if("choices"in l){if(!t)throw new TypeError("optGroup is not allowed");var u=l,d=u.choices.map(function(v){return ce(v,!1)}),f={id:0,label:ye(u.label)||u.value,active:!!d.length,disabled:!!u.disabled,choices:d};return f}var h=l,m={id:0,group:null,score:0,rank:0,value:h.value,label:h.label||h.value,active:Ae(h.active),selected:Ae(h.selected,!1),disabled:Ae(h.disabled,!1),placeholder:Ae(h.placeholder,!1),highlighted:!1,labelClass:Lt(h.labelClass),labelDescription:h.labelDescription,customProperties:h.customProperties};return m},Mi=function(e){return e.tagName==="INPUT"},Rt=function(e){return e.tagName==="SELECT"},Pi=function(e){return e.tagName==="OPTION"},Ni=function(e){return e.tagName==="OPTGROUP"},Di=function(e){Dt(t,e);function t(i){var s=i.element,r=i.classNames,o=i.template,l=i.extractPlaceholder,u=e.call(this,{element:s,classNames:r})||this;return u.template=o,u.extractPlaceholder=l,u}return Object.defineProperty(t.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),t.prototype.addOptions=function(i){var s=this,r=document.createDocumentFragment();i.forEach(function(o){var l=o;if(!l.element){var u=s.template(l);r.appendChild(u),l.element=u}}),this.element.appendChild(r)},t.prototype.optionsAsChoices=function(){var i=this,s=[];return this.element.querySelectorAll(":scope > option, :scope > optgroup").forEach(function(r){Pi(r)?s.push(i._optionToChoice(r)):Ni(r)&&s.push(i._optgroupToChoice(r))}),s},t.prototype._optionToChoice=function(i){return!i.hasAttribute("value")&&i.hasAttribute("placeholder")&&(i.setAttribute("value",""),i.value=""),{id:0,group:null,score:0,rank:0,value:i.value,label:i.innerText,element:i,active:!0,selected:this.extractPlaceholder?i.selected:i.hasAttribute("selected"),disabled:i.disabled,highlighted:!1,placeholder:this.extractPlaceholder&&(!i.value||i.hasAttribute("placeholder")),labelClass:typeof i.dataset.labelClass<"u"?Lt(i.dataset.labelClass):void 0,labelDescription:typeof i.dataset.labelDescription<"u"?i.dataset.labelDescription:void 0,customProperties:Ci(i.dataset.customProperties)}},t.prototype._optgroupToChoice=function(i){var s=this,r=i.querySelectorAll("option"),o=Array.from(r).map(function(l){return s._optionToChoice(l)});return{id:0,label:i.label||"",element:i,active:!!o.length,disabled:i.disabled,choices:o}},t}(xt),xi={containerOuter:["choices"],containerInner:["choices__inner"],input:["choices__input"],inputCloned:["choices__input--cloned"],list:["choices__list"],listItems:["choices__list--multiple"],listSingle:["choices__list--single"],listDropdown:["choices__list--dropdown"],item:["choices__item"],itemSelectable:["choices__item--selectable"],itemDisabled:["choices__item--disabled"],itemChoice:["choices__item--choice"],description:["choices__description"],placeholder:["choices__placeholder"],group:["choices__group"],groupHeading:["choices__heading"],button:["choices__button"],activeState:["is-active"],focusState:["is-focused"],openState:["is-open"],disabledState:["is-disabled"],highlightedState:["is-highlighted"],selectedState:["is-selected"],flippedState:["is-flipped"],loadingState:["is-loading"],notice:["choices__notice"],addChoice:["choices__item--selectable","add-choice"],noResults:["has-no-results"],noChoices:["has-no-choices"]},St={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,closeDropdownOnSelect:"auto",singleModeForMultiSelect:!1,addChoices:!1,addItems:!0,addItemFilter:function(e){return!!e&&e!==""},removeItems:!0,removeItemButton:!1,removeItemButtonAlignLeft:!1,editItems:!1,allowHTML:!1,allowHtmlUserInput:!1,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:yi,shadowRoot:null,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(e){return'Press Enter to add <b>"'.concat(e,'"</b>')},removeItemIconText:function(){return"Remove item"},removeItemLabelText:function(e){return"Remove item: ".concat(e)},maxItemText:function(e){return"Only ".concat(e," values can be added")},valueComparer:function(e,t){return e===t},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:xi,appendGroupInSearch:!1},Ct=function(e){var t=e.itemEl;t&&(t.remove(),e.itemEl=void 0)};function Li(e,t,i){var s=e,r=!0;switch(t.type){case Y.ADD_ITEM:{t.item.selected=!0;var o=t.item.element;o&&(o.selected=!0,o.setAttribute("selected","")),s.push(t.item);break}case Y.REMOVE_ITEM:{t.item.selected=!1;var o=t.item.element;if(o){o.selected=!1,o.removeAttribute("selected");var l=o.parentElement;l&&Rt(l)&&l.type===ve.SelectOne&&(l.value="")}Ct(t.item),s=s.filter(function(h){return h.id!==t.item.id});break}case Y.REMOVE_CHOICE:{Ct(t.choice),s=s.filter(function(f){return f.id!==t.choice.id});break}case Y.HIGHLIGHT_ITEM:{var u=t.highlighted,d=s.find(function(f){return f.id===t.item.id});d&&d.highlighted!==u&&(d.highlighted=u,i&&wi(d,u?i.classNames.highlightedState:i.classNames.selectedState,u?i.classNames.selectedState:i.classNames.highlightedState));break}default:{r=!1;break}}return{state:s,update:r}}function Ri(e,t){var i=e,s=!0;switch(t.type){case Y.ADD_GROUP:{i.push(t.group);break}case Y.CLEAR_CHOICES:{i=[];break}default:{s=!1;break}}return{state:i,update:s}}function Vi(e,t,i){var s=e,r=!0;switch(t.type){case Y.ADD_CHOICE:{s.push(t.choice);break}case Y.REMOVE_CHOICE:{t.choice.choiceEl=void 0,t.choice.group&&(t.choice.group.choices=t.choice.group.choices.filter(function(l){return l.id!==t.choice.id})),s=s.filter(function(l){return l.id!==t.choice.id});break}case Y.ADD_ITEM:case Y.REMOVE_ITEM:{t.item.choiceEl=void 0;break}case Y.FILTER_CHOICES:{var o=[];t.results.forEach(function(l){o[l.item.id]=l}),s.forEach(function(l){var u=o[l.id];u!==void 0?(l.score=u.score,l.rank=u.rank,l.active=!0):(l.score=0,l.rank=0,l.active=!1),i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Y.ACTIVATE_CHOICES:{s.forEach(function(l){l.active=t.active,i&&i.appendGroupInSearch&&(l.choiceEl=void 0)});break}case Y.CLEAR_CHOICES:{s=[];break}default:{r=!1;break}}return{state:s,update:r}}var wt={groups:Ri,items:Li,choices:Vi},Bi=function(){function e(t){this._state=this.defaultState,this._listeners=[],this._txn=0,this._context=t}return Object.defineProperty(e.prototype,"defaultState",{get:function(){return{groups:[],items:[],choices:[]}},enumerable:!1,configurable:!0}),e.prototype.changeSet=function(t){return{groups:t,items:t,choices:t}},e.prototype.reset=function(){this._state=this.defaultState;var t=this.changeSet(!0);this._txn?this._changeSet=t:this._listeners.forEach(function(i){return i(t)})},e.prototype.subscribe=function(t){return this._listeners.push(t),this},e.prototype.dispatch=function(t){var i=this,s=this._state,r=!1,o=this._changeSet||this.changeSet(!1);Object.keys(wt).forEach(function(l){var u=wt[l](s[l],t,i._context);u.update&&(r=!0,o[l]=!0,s[l]=u.state)}),r&&(this._txn?this._changeSet=o:this._listeners.forEach(function(l){return l(o)}))},e.prototype.withTxn=function(t){this._txn++;try{t()}finally{if(this._txn=Math.max(0,this._txn-1),!this._txn){var i=this._changeSet;i&&(this._changeSet=void 0,this._listeners.forEach(function(s){return s(i)}))}}},Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(t){return!t.disabled&&t.active&&t.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeChoices",{get:function(){return this.choices.filter(function(t){return t.active})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"searchableChoices",{get:function(){return this.choices.filter(function(t){return!t.disabled&&!t.placeholder})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeGroups",{get:function(){var t=this;return this.state.groups.filter(function(i){var s=i.active&&!i.disabled,r=t.state.choices.some(function(o){return o.active&&!o.disabled});return s&&r},[])},enumerable:!1,configurable:!0}),e.prototype.inTxn=function(){return this._txn>0},e.prototype.getChoiceById=function(t){return this.activeChoices.find(function(i){return i.id===t})},e.prototype.getGroupById=function(t){return this.groups.find(function(i){return i.id===t})},e}(),ee={noChoices:"no-choices",noResults:"no-results",addChoice:"add-choice",generic:""};function Fi(e,t,i){return(t=Ki(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function At(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),i.push.apply(i,s)}return i}function Ie(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?At(Object(i),!0).forEach(function(s){Fi(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):At(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Ui(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,t||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ki(e){var t=Ui(e,"string");return typeof t=="symbol"?t:t+""}function me(e){return Array.isArray?Array.isArray(e):Ft(e)==="[object Array]"}var Hi=1/0;function qi(e){if(typeof e=="string")return e;let t=e+"";return t=="0"&&1/e==-Hi?"-0":t}function ji(e){return e==null?"":qi(e)}function de(e){return typeof e=="string"}function Vt(e){return typeof e=="number"}function Wi(e){return e===!0||e===!1||zi(e)&&Ft(e)=="[object Boolean]"}function Bt(e){return typeof e=="object"}function zi(e){return Bt(e)&&e!==null}function oe(e){return e!=null}function Ue(e){return!e.trim().length}function Ft(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var Gi="Incorrect 'index' type",Yi=e=>`Invalid value for key ${e}`,Xi=e=>`Pattern length exceeds max of ${e}.`,Ji=e=>`Missing ${e} property in key`,Zi=e=>`Property 'weight' in key '${e}' must be a positive integer`,Tt=Object.prototype.hasOwnProperty,je=class{constructor(t){this._keys=[],this._keyMap={};let i=0;t.forEach(s=>{let r=Ut(s);this._keys.push(r),this._keyMap[r.id]=r,i+=r.weight}),this._keys.forEach(s=>{s.weight/=i})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function Ut(e){let t=null,i=null,s=null,r=1,o=null;if(de(e)||me(e))s=e,t=kt(e),i=We(e);else{if(!Tt.call(e,"name"))throw new Error(Ji("name"));let l=e.name;if(s=l,Tt.call(e,"weight")&&(r=e.weight,r<=0))throw new Error(Zi(l));t=kt(l),i=We(l),o=e.getFn}return{path:t,id:i,weight:r,src:s,getFn:o}}function kt(e){return me(e)?e:e.split(".")}function We(e){return me(e)?e.join("."):e}function Qi(e,t){let i=[],s=!1,r=(o,l,u)=>{if(oe(o))if(!l[u])i.push(o);else{let d=l[u],f=o[d];if(!oe(f))return;if(u===l.length-1&&(de(f)||Vt(f)||Wi(f)))i.push(ji(f));else if(me(f)){s=!0;for(let h=0,m=f.length;h<m;h+=1)r(f[h],l,u+1)}else l.length&&r(f,l,u+1)}};return r(e,de(t)?t.split("."):t,0),s?i:i[0]}var $i={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},en={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},tn={location:0,threshold:.6,distance:100},nn={useExtendedSearch:!1,getFn:Qi,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},O=Ie(Ie(Ie(Ie({},en),$i),tn),nn),sn=/[^ ]+/g;function rn(e=1,t=3){let i=new Map,s=Math.pow(10,t);return{get(r){let o=r.match(sn).length;if(i.has(o))return i.get(o);let l=1/Math.pow(o,.5*e),u=parseFloat(Math.round(l*s)/s);return i.set(o,u),u},clear(){i.clear()}}}var ke=class{constructor({getFn:t=O.getFn,fieldNormWeight:i=O.fieldNormWeight}={}){this.norm=rn(i,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((i,s)=>{this._keysMap[i.id]=s})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,de(this.docs[0])?this.docs.forEach((t,i)=>{this._addString(t,i)}):this.docs.forEach((t,i)=>{this._addObject(t,i)}),this.norm.clear())}add(t){let i=this.size();de(t)?this._addString(t,i):this._addObject(t,i)}removeAt(t){this.records.splice(t,1);for(let i=t,s=this.size();i<s;i+=1)this.records[i].i-=1}getValueForItemAtKeyId(t,i){return t[this._keysMap[i]]}size(){return this.records.length}_addString(t,i){if(!oe(t)||Ue(t))return;let s={v:t,i,n:this.norm.get(t)};this.records.push(s)}_addObject(t,i){let s={i,$:{}};this.keys.forEach((r,o)=>{let l=r.getFn?r.getFn(t):this.getFn(t,r.path);if(oe(l)){if(me(l)){let u=[],d=[{nestedArrIndex:-1,value:l}];for(;d.length;){let{nestedArrIndex:f,value:h}=d.pop();if(oe(h))if(de(h)&&!Ue(h)){let m={v:h,i:f,n:this.norm.get(h)};u.push(m)}else me(h)&&h.forEach((m,v)=>{d.push({nestedArrIndex:v,value:m})})}s.$[o]=u}else if(de(l)&&!Ue(l)){let u={v:l,n:this.norm.get(l)};s.$[o]=u}}}),this.records.push(s)}toJSON(){return{keys:this.keys,records:this.records}}};function Kt(e,t,{getFn:i=O.getFn,fieldNormWeight:s=O.fieldNormWeight}={}){let r=new ke({getFn:i,fieldNormWeight:s});return r.setKeys(e.map(Ut)),r.setSources(t),r.create(),r}function on(e,{getFn:t=O.getFn,fieldNormWeight:i=O.fieldNormWeight}={}){let{keys:s,records:r}=e,o=new ke({getFn:t,fieldNormWeight:i});return o.setKeys(s),o.setIndexRecords(r),o}function Ne(e,{errors:t=0,currentLocation:i=0,expectedLocation:s=0,distance:r=O.distance,ignoreLocation:o=O.ignoreLocation}={}){let l=t/e.length;if(o)return l;let u=Math.abs(s-i);return r?l+u/r:u?1:l}function an(e=[],t=O.minMatchCharLength){let i=[],s=-1,r=-1,o=0;for(let l=e.length;o<l;o+=1){let u=e[o];u&&s===-1?s=o:!u&&s!==-1&&(r=o-1,r-s+1>=t&&i.push([s,r]),s=-1)}return e[o-1]&&o-s>=t&&i.push([s,o-1]),i}var be=32;function ln(e,t,i,{location:s=O.location,distance:r=O.distance,threshold:o=O.threshold,findAllMatches:l=O.findAllMatches,minMatchCharLength:u=O.minMatchCharLength,includeMatches:d=O.includeMatches,ignoreLocation:f=O.ignoreLocation}={}){if(t.length>be)throw new Error(Xi(be));let h=t.length,m=e.length,v=Math.max(0,Math.min(s,m)),w=o,g=v,I=u>1||d,B=I?Array(m):[],L;for(;(L=e.indexOf(t,g))>-1;){let Q=Ne(t,{currentLocation:L,expectedLocation:v,distance:r,ignoreLocation:f});if(w=Math.min(Q,w),g=L+h,I){let ne=0;for(;ne<h;)B[L+ne]=1,ne+=1}}g=-1;let G=[],q=1,te=h+m,_e=1<<h-1;for(let Q=0;Q<h;Q+=1){let ne=0,ae=te;for(;ne<ae;)Ne(t,{errors:Q,currentLocation:v+ae,expectedLocation:v,distance:r,ignoreLocation:f})<=w?ne=ae:te=ae,ae=Math.floor((te-ne)/2+ne);te=ae;let R=Math.max(1,v-ae+1),j=l?m:Math.min(v+ae,m)+h,W=Array(j+2);W[j+1]=(1<<Q)-1;for(let a=j;a>=R;a-=1){let c=a-1,b=i[e.charAt(c)];if(I&&(B[c]=+!!b),W[a]=(W[a+1]<<1|1)&b,Q&&(W[a]|=(G[a+1]|G[a])<<1|1|G[a+1]),W[a]&_e&&(q=Ne(t,{errors:Q,currentLocation:c,expectedLocation:v,distance:r,ignoreLocation:f}),q<=w)){if(w=q,g=c,g<=v)break;R=Math.max(1,2*v-g)}}if(Ne(t,{errors:Q+1,currentLocation:v,expectedLocation:v,distance:r,ignoreLocation:f})>w)break;G=W}let X={isMatch:g>=0,score:Math.max(.001,q)};if(I){let Q=an(B,u);Q.length?d&&(X.indices=Q):X.isMatch=!1}return X}function cn(e){let t={};for(let i=0,s=e.length;i<s;i+=1){let r=e.charAt(i);t[r]=(t[r]||0)|1<<s-i-1}return t}var De=class{constructor(t,{location:i=O.location,threshold:s=O.threshold,distance:r=O.distance,includeMatches:o=O.includeMatches,findAllMatches:l=O.findAllMatches,minMatchCharLength:u=O.minMatchCharLength,isCaseSensitive:d=O.isCaseSensitive,ignoreLocation:f=O.ignoreLocation}={}){if(this.options={location:i,threshold:s,distance:r,includeMatches:o,findAllMatches:l,minMatchCharLength:u,isCaseSensitive:d,ignoreLocation:f},this.pattern=d?t:t.toLowerCase(),this.chunks=[],!this.pattern.length)return;let h=(v,w)=>{this.chunks.push({pattern:v,alphabet:cn(v),startIndex:w})},m=this.pattern.length;if(m>be){let v=0,w=m%be,g=m-w;for(;v<g;)h(this.pattern.substr(v,be),v),v+=be;if(w){let I=m-be;h(this.pattern.substr(I),I)}}else h(this.pattern,0)}searchIn(t){let{isCaseSensitive:i,includeMatches:s}=this.options;if(i||(t=t.toLowerCase()),this.pattern===t){let g={isMatch:!0,score:0};return s&&(g.indices=[[0,t.length-1]]),g}let{location:r,distance:o,threshold:l,findAllMatches:u,minMatchCharLength:d,ignoreLocation:f}=this.options,h=[],m=0,v=!1;this.chunks.forEach(({pattern:g,alphabet:I,startIndex:B})=>{let{isMatch:L,score:G,indices:q}=ln(t,g,I,{location:r+B,distance:o,threshold:l,findAllMatches:u,minMatchCharLength:d,includeMatches:s,ignoreLocation:f});L&&(v=!0),m+=G,L&&q&&(h=[...h,...q])});let w={isMatch:v,score:v?m/this.chunks.length:1};return v&&s&&(w.indices=h),w}},he=class{constructor(t){this.pattern=t}static isMultiMatch(t){return Ot(t,this.multiRegex)}static isSingleMatch(t){return Ot(t,this.singleRegex)}search(){}};function Ot(e,t){let i=e.match(t);return i?i[1]:null}var ze=class extends he{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){let i=t===this.pattern;return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}},Ge=class extends he{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){let s=t.indexOf(this.pattern)===-1;return{isMatch:s,score:s?0:1,indices:[0,t.length-1]}}},Ye=class extends he{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){let i=t.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,this.pattern.length-1]}}},Xe=class extends he{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){let i=!t.startsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}},Je=class extends he{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){let i=t.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[t.length-this.pattern.length,t.length-1]}}},Ze=class extends he{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){let i=!t.endsWith(this.pattern);return{isMatch:i,score:i?0:1,indices:[0,t.length-1]}}},xe=class extends he{constructor(t,{location:i=O.location,threshold:s=O.threshold,distance:r=O.distance,includeMatches:o=O.includeMatches,findAllMatches:l=O.findAllMatches,minMatchCharLength:u=O.minMatchCharLength,isCaseSensitive:d=O.isCaseSensitive,ignoreLocation:f=O.ignoreLocation}={}){super(t),this._bitapSearch=new De(t,{location:i,threshold:s,distance:r,includeMatches:o,findAllMatches:l,minMatchCharLength:u,isCaseSensitive:d,ignoreLocation:f})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}},Le=class extends he{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let i=0,s,r=[],o=this.pattern.length;for(;(s=t.indexOf(this.pattern,i))>-1;)i=s+o,r.push([s,i-1]);let l=!!r.length;return{isMatch:l,score:l?0:1,indices:r}}},Qe=[ze,Le,Ye,Xe,Ze,Je,Ge,xe],Mt=Qe.length,un=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,dn="|";function hn(e,t={}){return e.split(dn).map(i=>{let s=i.trim().split(un).filter(o=>o&&!!o.trim()),r=[];for(let o=0,l=s.length;o<l;o+=1){let u=s[o],d=!1,f=-1;for(;!d&&++f<Mt;){let h=Qe[f],m=h.isMultiMatch(u);m&&(r.push(new h(m,t)),d=!0)}if(!d)for(f=-1;++f<Mt;){let h=Qe[f],m=h.isSingleMatch(u);if(m){r.push(new h(m,t));break}}}return r})}var pn=new Set([xe.type,Le.type]),$e=class{constructor(t,{isCaseSensitive:i=O.isCaseSensitive,includeMatches:s=O.includeMatches,minMatchCharLength:r=O.minMatchCharLength,ignoreLocation:o=O.ignoreLocation,findAllMatches:l=O.findAllMatches,location:u=O.location,threshold:d=O.threshold,distance:f=O.distance}={}){this.query=null,this.options={isCaseSensitive:i,includeMatches:s,minMatchCharLength:r,findAllMatches:l,ignoreLocation:o,location:u,threshold:d,distance:f},this.pattern=i?t:t.toLowerCase(),this.query=hn(this.pattern,this.options)}static condition(t,i){return i.useExtendedSearch}searchIn(t){let i=this.query;if(!i)return{isMatch:!1,score:1};let{includeMatches:s,isCaseSensitive:r}=this.options;t=r?t:t.toLowerCase();let o=0,l=[],u=0;for(let d=0,f=i.length;d<f;d+=1){let h=i[d];l.length=0,o=0;for(let m=0,v=h.length;m<v;m+=1){let w=h[m],{isMatch:g,indices:I,score:B}=w.search(t);if(g){if(o+=1,u+=B,s){let L=w.constructor.type;pn.has(L)?l=[...l,...I]:l.push(I)}}else{u=0,o=0,l.length=0;break}}if(o){let m={isMatch:!0,score:u/o};return s&&(m.indices=l),m}}return{isMatch:!1,score:1}}},et=[];function fn(...e){et.push(...e)}function tt(e,t){for(let i=0,s=et.length;i<s;i+=1){let r=et[i];if(r.condition(e,t))return new r(e,t)}return new De(e,t)}var Re={AND:"$and",OR:"$or"},it={PATH:"$path",PATTERN:"$val"},nt=e=>!!(e[Re.AND]||e[Re.OR]),mn=e=>!!e[it.PATH],_n=e=>!me(e)&&Bt(e)&&!nt(e),Pt=e=>({[Re.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function Ht(e,t,{auto:i=!0}={}){let s=r=>{let o=Object.keys(r),l=mn(r);if(!l&&o.length>1&&!nt(r))return s(Pt(r));if(_n(r)){let d=l?r[it.PATH]:o[0],f=l?r[it.PATTERN]:r[d];if(!de(f))throw new Error(Yi(d));let h={keyId:We(d),pattern:f};return i&&(h.searcher=tt(f,t)),h}let u={children:[],operator:o[0]};return o.forEach(d=>{let f=r[d];me(f)&&f.forEach(h=>{u.children.push(s(h))})}),u};return nt(e)||(e=Pt(e)),s(e)}function vn(e,{ignoreFieldNorm:t=O.ignoreFieldNorm}){e.forEach(i=>{let s=1;i.matches.forEach(({key:r,norm:o,score:l})=>{let u=r?r.weight:null;s*=Math.pow(l===0&&u?Number.EPSILON:l,(u||1)*(t?1:o))}),i.score=s})}function gn(e,t){let i=e.matches;t.matches=[],oe(i)&&i.forEach(s=>{if(!oe(s.indices)||!s.indices.length)return;let{indices:r,value:o}=s,l={indices:r,value:o};s.key&&(l.key=s.key.src),s.idx>-1&&(l.refIndex=s.idx),t.matches.push(l)})}function bn(e,t){t.score=e.score}function yn(e,t,{includeMatches:i=O.includeMatches,includeScore:s=O.includeScore}={}){let r=[];return i&&r.push(gn),s&&r.push(bn),e.map(o=>{let{idx:l}=o,u={item:t[l],refIndex:l};return r.length&&r.forEach(d=>{d(o,u)}),u})}var ge=class{constructor(t,i={},s){this.options=Ie(Ie({},O),i),this.options.useExtendedSearch,this._keyStore=new je(this.options.keys),this.setCollection(t,s)}setCollection(t,i){if(this._docs=t,i&&!(i instanceof ke))throw new Error(Gi);this._myIndex=i||Kt(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){oe(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){let i=[];for(let s=0,r=this._docs.length;s<r;s+=1){let o=this._docs[s];t(o,s)&&(this.removeAt(s),s-=1,r-=1,i.push(o))}return i}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:i=-1}={}){let{includeMatches:s,includeScore:r,shouldSort:o,sortFn:l,ignoreFieldNorm:u}=this.options,d=de(t)?de(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return vn(d,{ignoreFieldNorm:u}),o&&d.sort(l),Vt(i)&&i>-1&&(d=d.slice(0,i)),yn(d,this._docs,{includeMatches:s,includeScore:r})}_searchStringList(t){let i=tt(t,this.options),{records:s}=this._myIndex,r=[];return s.forEach(({v:o,i:l,n:u})=>{if(!oe(o))return;let{isMatch:d,score:f,indices:h}=i.searchIn(o);d&&r.push({item:o,idx:l,matches:[{score:f,value:o,norm:u,indices:h}]})}),r}_searchLogical(t){let i=Ht(t,this.options),s=(u,d,f)=>{if(!u.children){let{keyId:m,searcher:v}=u,w=this._findMatches({key:this._keyStore.get(m),value:this._myIndex.getValueForItemAtKeyId(d,m),searcher:v});return w&&w.length?[{idx:f,item:d,matches:w}]:[]}let h=[];for(let m=0,v=u.children.length;m<v;m+=1){let w=u.children[m],g=s(w,d,f);if(g.length)h.push(...g);else if(u.operator===Re.AND)return[]}return h},r=this._myIndex.records,o={},l=[];return r.forEach(({$:u,i:d})=>{if(oe(u)){let f=s(i,u,d);f.length&&(o[d]||(o[d]={idx:d,item:u,matches:[]},l.push(o[d])),f.forEach(({matches:h})=>{o[d].matches.push(...h)}))}}),l}_searchObjectList(t){let i=tt(t,this.options),{keys:s,records:r}=this._myIndex,o=[];return r.forEach(({$:l,i:u})=>{if(!oe(l))return;let d=[];s.forEach((f,h)=>{d.push(...this._findMatches({key:f,value:l[h],searcher:i}))}),d.length&&o.push({idx:u,item:l,matches:d})}),o}_findMatches({key:t,value:i,searcher:s}){if(!oe(i))return[];let r=[];if(me(i))i.forEach(({v:o,i:l,n:u})=>{if(!oe(o))return;let{isMatch:d,score:f,indices:h}=s.searchIn(o);d&&r.push({score:f,key:t,value:o,idx:l,norm:u,indices:h})});else{let{v:o,n:l}=i,{isMatch:u,score:d,indices:f}=s.searchIn(o);u&&r.push({score:d,key:t,value:o,norm:l,indices:f})}return r}};ge.version="7.0.0";ge.createIndex=Kt;ge.parseIndex=on;ge.config=O;ge.parseQuery=Ht;fn($e);var En=function(){function e(t){this._haystack=[],this._fuseOptions=re(re({},t.fuseOptions),{keys:ai([],t.searchFields,!0),includeMatches:!0})}return e.prototype.index=function(t){this._haystack=t,this._fuse&&this._fuse.setCollection(t)},e.prototype.reset=function(){this._haystack=[],this._fuse=void 0},e.prototype.isEmptyIndex=function(){return!this._haystack.length},e.prototype.search=function(t){this._fuse||(this._fuse=new ge(this._haystack,this._fuseOptions));var i=this._fuse.search(t);return i.map(function(s,r){return{item:s.item,score:s.score||0,rank:r+1}})},e}();function In(e){return new En(e)}var Sn=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},Ke=function(e,t,i){var s=e.dataset,r=t.customProperties,o=t.labelClass,l=t.labelDescription;o&&(s.labelClass=Be(o).join(" ")),l&&(s.labelDescription=l),i&&r&&(typeof r=="string"?s.customProperties=r:typeof r=="object"&&!Sn(r)&&(s.customProperties=JSON.stringify(r)))},Nt=function(e,t,i){var s=t&&e.querySelector("label[for='".concat(t,"']")),r=s&&s.innerText;r&&i.setAttribute("aria-label",r)},Cn={containerOuter:function(e,t,i,s,r,o,l){var u=e.classNames.containerOuter,d=document.createElement("div");return P(d,u),d.dataset.type=o,t&&(d.dir=t),s&&(d.tabIndex=0),i&&(d.setAttribute("role",r?"combobox":"listbox"),r?d.setAttribute("aria-autocomplete","list"):l||Nt(this._docRoot,this.passedElement.element.id,d),d.setAttribute("aria-haspopup","true"),d.setAttribute("aria-expanded","false")),l&&d.setAttribute("aria-labelledby",l),d},containerInner:function(e){var t=e.classNames.containerInner,i=document.createElement("div");return P(i,t),i},itemList:function(e,t){var i=e.searchEnabled,s=e.classNames,r=s.list,o=s.listSingle,l=s.listItems,u=document.createElement("div");return P(u,r),P(u,t?o:l),this._isSelectElement&&i&&u.setAttribute("role","listbox"),u},placeholder:function(e,t){var i=e.allowHTML,s=e.classNames.placeholder,r=document.createElement("div");return P(r,s),fe(r,i,t),r},item:function(e,t,i){var s=e.allowHTML,r=e.removeItemButtonAlignLeft,o=e.removeItemIconText,l=e.removeItemLabelText,u=e.classNames,d=u.item,f=u.button,h=u.highlightedState,m=u.itemSelectable,v=u.placeholder,w=ye(t.value),g=document.createElement("div");if(P(g,d),t.labelClass){var I=document.createElement("span");fe(I,s,t.label),P(I,t.labelClass),g.appendChild(I)}else fe(g,s,t.label);if(g.dataset.item="",g.dataset.id=t.id,g.dataset.value=w,Ke(g,t,!0),(t.disabled||this.containerOuter.isDisabled)&&g.setAttribute("aria-disabled","true"),this._isSelectElement&&(g.setAttribute("aria-selected","true"),g.setAttribute("role","option")),t.placeholder&&(P(g,v),g.dataset.placeholder=""),P(g,t.highlighted?h:m),i){t.disabled&&ue(g,m),g.dataset.deletable="";var B=document.createElement("button");B.type="button",P(B,f),fe(B,!0,Te(o,t.value));var L=Te(l,t.value);L&&B.setAttribute("aria-label",L),B.dataset.button="",r?g.insertAdjacentElement("afterbegin",B):g.appendChild(B)}return g},choiceList:function(e,t){var i=e.classNames.list,s=document.createElement("div");return P(s,i),t||s.setAttribute("aria-multiselectable","true"),s.setAttribute("role","listbox"),s},choiceGroup:function(e,t){var i=e.allowHTML,s=e.classNames,r=s.group,o=s.groupHeading,l=s.itemDisabled,u=t.id,d=t.label,f=t.disabled,h=ye(d),m=document.createElement("div");P(m,r),f&&P(m,l),m.setAttribute("role","group"),m.dataset.group="",m.dataset.id=u,m.dataset.value=h,f&&m.setAttribute("aria-disabled","true");var v=document.createElement("div");return P(v,o),fe(v,i,d||""),m.appendChild(v),m},choice:function(e,t,i,s){var r=e.allowHTML,o=e.classNames,l=o.item,u=o.itemChoice,d=o.itemSelectable,f=o.selectedState,h=o.itemDisabled,m=o.description,v=o.placeholder,w=t.label,g=ye(t.value),I=document.createElement("div");I.id=t.elementId,P(I,l),P(I,u),s&&typeof w=="string"&&(w=st(r,w),w+=" (".concat(s,")"),w={trusted:w});var B=I;if(t.labelClass){var L=document.createElement("span");fe(L,r,w),P(L,t.labelClass),B=L,I.appendChild(L)}else fe(I,r,w);if(t.labelDescription){var G="".concat(t.elementId,"-description");B.setAttribute("aria-describedby",G);var q=document.createElement("span");fe(q,r,t.labelDescription),q.id=G,P(q,m),I.appendChild(q)}return t.selected&&P(I,f),t.placeholder&&P(I,v),I.setAttribute("role",t.group?"treeitem":"option"),I.dataset.choice="",I.dataset.id=t.id,I.dataset.value=g,i&&(I.dataset.selectText=i),t.group&&(I.dataset.groupId="".concat(t.group.id)),Ke(I,t,!1),t.disabled?(P(I,h),I.dataset.choiceDisabled="",I.setAttribute("aria-disabled","true")):(P(I,d),I.dataset.choiceSelectable=""),I},input:function(e,t){var i=e.classNames,s=i.input,r=i.inputCloned,o=e.labelId,l=document.createElement("input");return l.type="search",P(l,s),P(l,r),l.autocomplete="off",l.autocapitalize="off",l.spellcheck=!1,l.setAttribute("role","textbox"),l.setAttribute("aria-autocomplete","list"),t?l.setAttribute("aria-label",t):o||Nt(this._docRoot,this.passedElement.element.id,l),l},dropdown:function(e){var t=e.classNames,i=t.list,s=t.listDropdown,r=document.createElement("div");return P(r,i),P(r,s),r.setAttribute("aria-expanded","false"),r},notice:function(e,t,i){var s=e.classNames,r=s.item,o=s.itemChoice,l=s.addChoice,u=s.noResults,d=s.noChoices,f=s.notice;i===void 0&&(i=ee.generic);var h=document.createElement("div");switch(fe(h,!0,t),P(h,r),P(h,o),P(h,f),i){case ee.addChoice:P(h,l);break;case ee.noResults:P(h,u);break;case ee.noChoices:P(h,d);break}return i===ee.addChoice&&(h.dataset.choiceSelectable="",h.dataset.choice=""),h},option:function(e){var t=ye(e.label),i=new Option(t,e.value,!1,e.selected);return Ke(i,e,!0),i.disabled=e.disabled,e.selected&&i.setAttribute("selected",""),i}},wn="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,An={},He=function(e){if(e)return e.dataset.id?parseInt(e.dataset.id,10):void 0},we="[data-choice-selectable]",qt=function(){function e(t,i){t===void 0&&(t="[data-choice]"),i===void 0&&(i={});var s=this;this.initialisedOK=void 0,this._hasNonChoicePlaceholder=!1,this._lastAddedChoiceId=0,this._lastAddedGroupId=0;var r=e.defaults;this.config=re(re(re({},r.allOptions),r.options),i),li.forEach(function(L){s.config[L]=re(re(re({},r.allOptions[L]),r.options[L]),i[L])});var o=this.config;o.silent||this._validateConfig();var l=o.shadowRoot||document.documentElement;this._docRoot=l;var u=typeof t=="string"?l.querySelector(t):t;if(!u||typeof u!="object"||!(Mi(u)||Rt(u)))throw TypeError(!u&&typeof t=="string"?"Selector ".concat(t," failed to find an element"):"Expected one of the following types text|select-one|select-multiple");var d=u.type,f=d===ve.Text;(f||o.maxItemCount!==1)&&(o.singleModeForMultiSelect=!1),o.singleModeForMultiSelect&&(d=ve.SelectMultiple);var h=d===ve.SelectOne,m=d===ve.SelectMultiple,v=h||m;if(this._elementType=d,this._isTextElement=f,this._isSelectOneElement=h,this._isSelectMultipleElement=m,this._isSelectElement=h||m,this._canAddUserChoices=f&&o.addItems||v&&o.addChoices,typeof o.renderSelectedChoices!="boolean"&&(o.renderSelectedChoices=o.renderSelectedChoices==="always"||h),o.closeDropdownOnSelect==="auto"?o.closeDropdownOnSelect=f||h||o.singleModeForMultiSelect:o.closeDropdownOnSelect=Ae(o.closeDropdownOnSelect),o.placeholder&&(o.placeholderValue?this._hasNonChoicePlaceholder=!0:u.dataset.placeholder&&(this._hasNonChoicePlaceholder=!0,o.placeholderValue=u.dataset.placeholder)),i.addItemFilter&&typeof i.addItemFilter!="function"){var w=i.addItemFilter instanceof RegExp?i.addItemFilter:new RegExp(i.addItemFilter);o.addItemFilter=w.test.bind(w)}if(this._isTextElement)this.passedElement=new Oi({element:u,classNames:o.classNames});else{var g=u;this.passedElement=new Di({element:g,classNames:o.classNames,template:function(L){return s._templates.option(L)},extractPlaceholder:o.placeholder&&!this._hasNonChoicePlaceholder})}if(this.initialised=!1,this._store=new Bi(o),this._currentValue="",o.searchEnabled=!f&&o.searchEnabled||m,this._canSearch=o.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=mi(u,"choices-"),this._direction=u.dir,!this._direction){var I=window.getComputedStyle(u).direction,B=window.getComputedStyle(document.documentElement).direction;I!==B&&(this._direction=I)}if(this._idNames={itemChoice:"item-choice"},this._templates=r.templates,this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onInput=this._onInput.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){o.silent||console.warn("Trying to initialise Choices on element already initialised",{element:t}),this.initialised=!0,this.initialisedOK=!1;return}this.init(),this._initialItems=this._store.items.map(function(L){return L.value})}return Object.defineProperty(e,"defaults",{get:function(){return Object.preventExtensions({get options(){return An},get allOptions(){return St},get templates(){return Cn}})},enumerable:!1,configurable:!0}),e.prototype.init=function(){if(!(this.initialised||this.initialisedOK!==void 0)){this._searcher=In(this.config),this._loadChoices(),this._createTemplates(),this._createElements(),this._createStructure(),this._isTextElement&&!this.config.addItems||this.passedElement.element.hasAttribute("disabled")||this.passedElement.element.closest("fieldset:disabled")?this.disable():(this.enable(),this._addEventListeners()),this._initStore(),this.initialised=!0,this.initialisedOK=!0;var t=this.config.callbackOnInit;typeof t=="function"&&t.call(this)}},e.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this._store._listeners=[],this.clearStore(!1),this._stopSearch(),this._templates=e.defaults.templates,this.initialised=!1,this.initialisedOK=void 0)},e.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},e.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},e.prototype.highlightItem=function(t,i){if(i===void 0&&(i=!0),!t||!t.id)return this;var s=this._store.items.find(function(r){return r.id===t.id});return!s||s.highlighted?this:(this._store.dispatch(Pe(s,!0)),i&&this.passedElement.triggerEvent(se.highlightItem,this._getChoiceForOutput(s)),this)},e.prototype.unhighlightItem=function(t,i){if(i===void 0&&(i=!0),!t||!t.id)return this;var s=this._store.items.find(function(r){return r.id===t.id});return!s||!s.highlighted?this:(this._store.dispatch(Pe(s,!1)),i&&this.passedElement.triggerEvent(se.unhighlightItem,this._getChoiceForOutput(s)),this)},e.prototype.highlightAll=function(){var t=this;return this._store.withTxn(function(){t._store.items.forEach(function(i){i.highlighted||(t._store.dispatch(Pe(i,!0)),t.passedElement.triggerEvent(se.highlightItem,t._getChoiceForOutput(i)))})}),this},e.prototype.unhighlightAll=function(){var t=this;return this._store.withTxn(function(){t._store.items.forEach(function(i){i.highlighted&&(t._store.dispatch(Pe(i,!1)),t.passedElement.triggerEvent(se.highlightItem,t._getChoiceForOutput(i)))})}),this},e.prototype.removeActiveItemsByValue=function(t){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(s){return s.value===t}).forEach(function(s){return i._removeItem(s)})}),this},e.prototype.removeActiveItems=function(t){var i=this;return this._store.withTxn(function(){i._store.items.filter(function(s){var r=s.id;return r!==t}).forEach(function(s){return i._removeItem(s)})}),this},e.prototype.removeHighlightedItems=function(t){var i=this;return t===void 0&&(t=!1),this._store.withTxn(function(){i._store.highlightedActiveItems.forEach(function(s){i._removeItem(s),t&&i._triggerChange(s.value)})}),this},e.prototype.showDropdown=function(t){var i=this;return this.dropdown.isActive?this:(t===void 0&&(t=!this._canSearch),requestAnimationFrame(function(){i.dropdown.show();var s=i.dropdown.element.getBoundingClientRect();i.containerOuter.open(s.bottom,s.height),t||i.input.focus(),i.passedElement.triggerEvent(se.showDropdown)}),this)},e.prototype.hideDropdown=function(t){var i=this;return this.dropdown.isActive?(requestAnimationFrame(function(){i.dropdown.hide(),i.containerOuter.close(),!t&&i._canSearch&&(i.input.removeActiveDescendant(),i.input.blur()),i.passedElement.triggerEvent(se.hideDropdown)}),this):this},e.prototype.getValue=function(t){var i=this,s=this._store.items.map(function(r){return t?r.value:i._getChoiceForOutput(r)});return this._isSelectOneElement||this.config.singleModeForMultiSelect?s[0]:s},e.prototype.setValue=function(t){var i=this;return this.initialisedOK?(this._store.withTxn(function(){t.forEach(function(s){s&&i._addChoice(ce(s,!1))})}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setValue"),this)},e.prototype.setChoiceByValue=function(t){var i=this;return this.initialisedOK?this._isTextElement?this:(this._store.withTxn(function(){var s=Array.isArray(t)?t:[t];s.forEach(function(r){return i._findAndSelectChoiceByValue(r)}),i.unhighlightAll()}),this._searcher.reset(),this):(this._warnChoicesInitFailed("setChoiceByValue"),this)},e.prototype.setChoices=function(t,i,s,r,o){var l=this;if(t===void 0&&(t=[]),i===void 0&&(i="value"),s===void 0&&(s="label"),r===void 0&&(r=!1),o===void 0&&(o=!0),!this.initialisedOK)return this._warnChoicesInitFailed("setChoices"),this;if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof i!="string"||!i)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(r&&this.clearChoices(),typeof t=="function"){var u=t(this);if(typeof Promise=="function"&&u instanceof Promise)return new Promise(function(d){return requestAnimationFrame(d)}).then(function(){return l._handleLoadingState(!0)}).then(function(){return u}).then(function(d){return l.setChoices(d,i,s,r)}).catch(function(d){l.config.silent||console.error(d)}).then(function(){return l._handleLoadingState(!1)}).then(function(){return l});if(!Array.isArray(u))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof u));return this.setChoices(u,i,s,!1)}if(!Array.isArray(t))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._store.withTxn(function(){o&&(l._isSearching=!1);var d=i==="value",f=s==="label";t.forEach(function(h){if("choices"in h){var m=h;f||(m=re(re({},m),{label:m[s]})),l._addGroup(ce(m,!0))}else{var v=h;(!f||!d)&&(v=re(re({},v),{value:v[i],label:v[s]})),l._addChoice(ce(v,!1))}}),l.unhighlightAll()}),this._searcher.reset(),this},e.prototype.refresh=function(t,i,s){var r=this;return t===void 0&&(t=!1),i===void 0&&(i=!1),s===void 0&&(s=!1),this._isSelectElement?(this._store.withTxn(function(){var o=r.passedElement.optionsAsChoices(),l={};s||r._store.items.forEach(function(d){d.id&&d.active&&d.selected&&!d.disabled&&(l[d.value]=!0)}),r.clearStore(!1);var u=function(d){s?r._store.dispatch(gt(d)):l[d.value]&&(d.selected=!0)};o.forEach(function(d){if("choices"in d){d.choices.forEach(u);return}u(d)}),r._addPredefinedChoices(o,i,t),r._isSearching&&r._searchChoices(r.input.value)}),this):(this.config.silent||console.warn("refresh method can only be used on choices backed by a <select> element"),this)},e.prototype.removeChoice=function(t){var i=this._store.choices.find(function(s){return s.value===t});return i?(this._clearNotice(),this._store.dispatch(vt(i)),this._searcher.reset(),i.selected&&this.passedElement.triggerEvent(se.removeItem,this._getChoiceForOutput(i)),this):this},e.prototype.clearChoices=function(){var t=this;return this._store.withTxn(function(){t._store.choices.forEach(function(i){i.selected||t._store.dispatch(vt(i))})}),this._searcher.reset(),this},e.prototype.clearStore=function(t){return t===void 0&&(t=!0),this._stopSearch(),t&&this.passedElement.element.replaceChildren(""),this.itemList.element.replaceChildren(""),this.choiceList.element.replaceChildren(""),this._clearNotice(),this._store.reset(),this._lastAddedChoiceId=0,this._lastAddedGroupId=0,this._searcher.reset(),this},e.prototype.clearInput=function(){var t=!this._isSelectOneElement;return this.input.clear(t),this._stopSearch(),this},e.prototype._validateConfig=function(){var t=this.config,i=Si(t,St);i.length&&console.warn("Unknown config option(s) passed",i.join(", ")),t.allowHTML&&t.allowHtmlUserInput&&(t.addItems&&console.warn("Warning: allowHTML/allowHtmlUserInput/addItems all being true is strongly not recommended and may lead to XSS attacks"),t.addChoices&&console.warn("Warning: allowHTML/allowHtmlUserInput/addChoices all being true is strongly not recommended and may lead to XSS attacks"))},e.prototype._render=function(t){t===void 0&&(t={choices:!0,groups:!0,items:!0}),!this._store.inTxn()&&(this._isSelectElement&&(t.choices||t.groups)&&this._renderChoices(),t.items&&this._renderItems())},e.prototype._renderChoices=function(){var t=this;if(this._canAddItems()){var i=this,s=i.config,r=i._isSearching,o=this._store,l=o.activeGroups,u=o.activeChoices,d=0;if(r&&s.searchResultLimit>0?d=s.searchResultLimit:s.renderChoiceLimit>0&&(d=s.renderChoiceLimit),this._isSelectElement){var f=u.filter(function(g){return!g.element});f.length&&this.passedElement.addOptions(f)}var h=document.createDocumentFragment(),m=function(g){return g.filter(function(I){return!I.placeholder&&(r?!!I.rank:s.renderSelectedChoices||!I.selected)})},v=!1,w=function(g,I,B){r?g.sort(Ei):s.shouldSort&&g.sort(s.sorter);var L=g.length;L=!I&&d&&L>d?d:L,L--,g.every(function(G,q){var te=G.choiceEl||t._templates.choice(s,G,s.itemSelectText,B);return G.choiceEl=te,h.appendChild(te),!G.disabled&&(r||!G.selected)&&(v=!0),q<L})};u.length&&(s.resetScrollPosition&&requestAnimationFrame(function(){return t.choiceList.scrollToTop()}),!this._hasNonChoicePlaceholder&&!r&&this._isSelectOneElement&&w(u.filter(function(g){return g.placeholder&&!g.group}),!1,void 0),l.length&&!r?(s.shouldSort&&l.sort(s.sorter),w(u.filter(function(g){return!g.placeholder&&!g.group}),!1,void 0),l.forEach(function(g){var I=m(g.choices);if(I.length){if(g.label){var B=g.groupEl||t._templates.choiceGroup(t.config,g);g.groupEl=B,B.remove(),h.appendChild(B)}w(I,!0,s.appendGroupInSearch&&r?g.label:void 0)}})):w(m(u),!1,void 0)),v||(this._notice||(this._notice={text:yt(r?s.noResultsText:s.noChoicesText),type:r?ee.noResults:ee.noChoices}),h.replaceChildren("")),this._renderNotice(h),this.choiceList.element.replaceChildren(h),v&&this._highlightChoice()}},e.prototype._renderItems=function(){var t=this,i=this._store.items||[],s=this.itemList.element,r=this.config,o=document.createDocumentFragment(),l=function(m){return s.querySelector('[data-item][data-id="'.concat(m.id,'"]'))},u=function(m){var v=m.itemEl;v&&v.parentElement||(v=l(m)||t._templates.item(r,m,r.removeItemButton),m.itemEl=v,o.appendChild(v))};i.forEach(u);var d=!!o.childNodes.length;if(this._isSelectOneElement&&this._hasNonChoicePlaceholder){var f=s.children.length;if(d||f>1){var h=s.querySelector(Ce(r.classNames.placeholder));h&&h.remove()}else f||(d=!0,u(ce({selected:!0,value:"",label:r.placeholderValue||"",placeholder:!0},!1)))}d&&(s.append(o),r.shouldSortItems&&!this._isSelectOneElement&&(i.sort(r.sorter),i.forEach(function(m){var v=l(m);v&&(v.remove(),o.append(v))}),s.append(o))),this._isTextElement&&(this.passedElement.value=i.map(function(m){var v=m.value;return v}).join(r.delimiter))},e.prototype._displayNotice=function(t,i,s){s===void 0&&(s=!0);var r=this._notice;if(r&&(r.type===i&&r.text===t||r.type===ee.addChoice&&(i===ee.noResults||i===ee.noChoices))){s&&this.showDropdown(!0);return}this._clearNotice(),this._notice=t?{text:t,type:i}:void 0,this._renderNotice(),s&&t&&this.showDropdown(!0)},e.prototype._clearNotice=function(){if(this._notice){var t=this.choiceList.element.querySelector(Ce(this.config.classNames.notice));t&&t.remove(),this._notice=void 0}},e.prototype._renderNotice=function(t){var i=this._notice;if(i){var s=this._templates.notice(this.config,i.text,i.type);t?t.append(s):this.choiceList.prepend(s)}},e.prototype._getChoiceForOutput=function(t,i){return{id:t.id,highlighted:t.highlighted,labelClass:t.labelClass,labelDescription:t.labelDescription,customProperties:t.customProperties,disabled:t.disabled,active:t.active,label:t.label,placeholder:t.placeholder,value:t.value,groupValue:t.group?t.group.label:void 0,element:t.element,keyCode:i}},e.prototype._triggerChange=function(t){t!=null&&this.passedElement.triggerEvent(se.change,{value:t})},e.prototype._handleButtonAction=function(t){var i=this,s=this._store.items;if(!(!s.length||!this.config.removeItems||!this.config.removeItemButton)){var r=t&&He(t.parentElement),o=r&&s.find(function(l){return l.id===r});o&&this._store.withTxn(function(){if(i._removeItem(o),i._triggerChange(o.value),i._isSelectOneElement&&!i._hasNonChoicePlaceholder){var l=i._store.choices.reverse().find(function(u){return!u.disabled&&u.placeholder});l&&(i._addItem(l),i.unhighlightAll(),l.value&&i._triggerChange(l.value))}})}},e.prototype._handleItemAction=function(t,i){var s=this;i===void 0&&(i=!1);var r=this._store.items;if(!(!r.length||!this.config.removeItems||this._isSelectOneElement)){var o=He(t);o&&(r.forEach(function(l){l.id===o&&!l.highlighted?s.highlightItem(l):!i&&l.highlighted&&s.unhighlightItem(l)}),this.input.focus())}},e.prototype._handleChoiceAction=function(t){var i=this,s=He(t),r=s&&this._store.getChoiceById(s);if(!r||r.disabled)return!1;var o=this.dropdown.isActive;if(!r.selected){if(!this._canAddItems())return!0;this._store.withTxn(function(){i._addItem(r,!0,!0),i.clearInput(),i.unhighlightAll()}),this._triggerChange(r.value)}return o&&this.config.closeDropdownOnSelect&&(this.hideDropdown(!0),this.containerOuter.element.focus()),!0},e.prototype._handleBackspace=function(t){var i=this.config;if(!(!i.removeItems||!t.length)){var s=t[t.length-1],r=t.some(function(o){return o.highlighted});i.editItems&&!r&&s?(this.input.value=s.value,this.input.setWidth(),this._removeItem(s),this._triggerChange(s.value)):(r||this.highlightItem(s,!1),this.removeHighlightedItems(!0))}},e.prototype._loadChoices=function(){var t,i=this,s=this.config;if(this._isTextElement){if(this._presetChoices=s.items.map(function(l){return ce(l,!1)}),this.passedElement.value){var r=this.passedElement.value.split(s.delimiter).map(function(l){return ce(l,!1,i.config.allowHtmlUserInput)});this._presetChoices=this._presetChoices.concat(r)}this._presetChoices.forEach(function(l){l.selected=!0})}else if(this._isSelectElement){this._presetChoices=s.choices.map(function(l){return ce(l,!0)});var o=this.passedElement.optionsAsChoices();o&&(t=this._presetChoices).push.apply(t,o)}},e.prototype._handleLoadingState=function(t){t===void 0&&(t=!0);var i=this.itemList.element;t?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?i.replaceChildren(this._templates.placeholder(this.config,this.config.loadingText)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?(i.replaceChildren(""),this._render()):this.input.placeholder=this._placeholderValue||"")},e.prototype._handleSearch=function(t){if(this.input.isFocussed)if(t!==null&&typeof t<"u"&&t.length>=this.config.searchFloor){var i=this.config.searchChoices?this._searchChoices(t):0;i!==null&&this.passedElement.triggerEvent(se.search,{value:t,resultCount:i})}else this._store.choices.some(function(s){return!s.active})&&this._stopSearch()},e.prototype._canAddItems=function(){var t=this.config,i=t.maxItemCount,s=t.maxItemText;return!t.singleModeForMultiSelect&&i>0&&i<=this._store.items.length?(this.choiceList.element.replaceChildren(""),this._notice=void 0,this._displayNotice(typeof s=="function"?s(i):s,ee.addChoice),!1):!0},e.prototype._canCreateItem=function(t){var i=this.config,s=!0,r="";if(s&&typeof i.addItemFilter=="function"&&!i.addItemFilter(t)&&(s=!1,r=Te(i.customAddItemText,t)),s){var o=this._store.choices.find(function(l){return i.valueComparer(l.value,t)});if(this._isSelectElement){if(o)return this._displayNotice("",ee.addChoice),!1}else this._isTextElement&&!i.duplicateItemsAllowed&&o&&(s=!1,r=Te(i.uniqueItemText,t))}return s&&(r=Te(i.addItemText,t)),r&&this._displayNotice(r,ee.addChoice),s},e.prototype._searchChoices=function(t){var i=t.trim().replace(/\s{2,}/," ");if(!i.length||i===this._currentValue)return null;var s=this._searcher;s.isEmptyIndex()&&s.index(this._store.searchableChoices);var r=s.search(i);this._currentValue=i,this._highlightPosition=0,this._isSearching=!0;var o=this._notice,l=o&&o.type;return l!==ee.addChoice&&(r.length?this._clearNotice():this._displayNotice(yt(this.config.noResultsText),ee.noResults)),this._store.dispatch(ui(r)),r.length},e.prototype._stopSearch=function(){this._isSearching&&(this._currentValue="",this._isSearching=!1,this._clearNotice(),this._store.dispatch(di(!0)),this.passedElement.triggerEvent(se.search,{value:"",resultCount:0}))},e.prototype._addEventListeners=function(){var t=this._docRoot,i=this.containerOuter.element,s=this.input.element;t.addEventListener("touchend",this._onTouchEnd,!0),i.addEventListener("keydown",this._onKeyDown,!0),i.addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("click",this._onClick,{passive:!0}),t.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(i.addEventListener("focus",this._onFocus,{passive:!0}),i.addEventListener("blur",this._onBlur,{passive:!0})),s.addEventListener("keyup",this._onKeyUp,{passive:!0}),s.addEventListener("input",this._onInput,{passive:!0}),s.addEventListener("focus",this._onFocus,{passive:!0}),s.addEventListener("blur",this._onBlur,{passive:!0}),s.form&&s.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},e.prototype._removeEventListeners=function(){var t=this._docRoot,i=this.containerOuter.element,s=this.input.element;t.removeEventListener("touchend",this._onTouchEnd,!0),i.removeEventListener("keydown",this._onKeyDown,!0),i.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("click",this._onClick),t.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(i.removeEventListener("focus",this._onFocus),i.removeEventListener("blur",this._onBlur)),s.removeEventListener("keyup",this._onKeyUp),s.removeEventListener("input",this._onInput),s.removeEventListener("focus",this._onFocus),s.removeEventListener("blur",this._onBlur),s.form&&s.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},e.prototype._onKeyDown=function(t){var i=t.keyCode,s=this.dropdown.isActive,r=t.key.length===1||t.key.length===2&&t.key.charCodeAt(0)>=55296||t.key==="Unidentified";switch(!this._isTextElement&&!s&&i!==$.ESC_KEY&&i!==$.TAB_KEY&&i!==$.SHIFT_KEY&&(this.showDropdown(),!this.input.isFocussed&&r&&(this.input.value+=t.key,t.key===" "&&t.preventDefault())),i){case $.A_KEY:return this._onSelectKey(t,this.itemList.element.hasChildNodes());case $.ENTER_KEY:return this._onEnterKey(t,s);case $.ESC_KEY:return this._onEscapeKey(t,s);case $.UP_KEY:case $.PAGE_UP_KEY:case $.DOWN_KEY:case $.PAGE_DOWN_KEY:return this._onDirectionKey(t,s);case $.DELETE_KEY:case $.BACK_KEY:return this._onDeleteKey(t,this._store.items,this.input.isFocussed)}},e.prototype._onKeyUp=function(){this._canSearch=this.config.searchEnabled},e.prototype._onInput=function(){var t=this.input.value;if(!t){this._isTextElement?this.hideDropdown(!0):this._stopSearch();return}this._canAddItems()&&(this._canSearch&&this._handleSearch(t),this._canAddUserChoices&&(this._canCreateItem(t),this._isSelectElement&&(this._highlightPosition=0,this._highlightChoice())))},e.prototype._onSelectKey=function(t,i){if((t.ctrlKey||t.metaKey)&&i){this._canSearch=!1;var s=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;s&&this.highlightAll()}},e.prototype._onEnterKey=function(t,i){var s=this,r=this.input.value,o=t.target;if(t.preventDefault(),o&&o.hasAttribute("data-button")){this._handleButtonAction(o);return}if(!i){(this._isSelectElement||this._notice)&&this.showDropdown();return}var l=this.dropdown.element.querySelector(Ce(this.config.classNames.highlightedState));if(!(l&&this._handleChoiceAction(l))){if(!o||!r){this.hideDropdown(!0);return}if(this._canAddItems()){var u=!1;this._store.withTxn(function(){if(u=s._findAndSelectChoiceByValue(r,!0),!u){if(!s._canAddUserChoices||!s._canCreateItem(r))return;s._addChoice(ce(r,!1,s.config.allowHtmlUserInput),!0,!0),u=!0}s.clearInput(),s.unhighlightAll()}),u&&(this._triggerChange(r),this.config.closeDropdownOnSelect&&this.hideDropdown(!0))}}},e.prototype._onEscapeKey=function(t,i){i&&(t.stopPropagation(),this.hideDropdown(!0),this._stopSearch(),this.containerOuter.element.focus())},e.prototype._onDirectionKey=function(t,i){var s=t.keyCode;if(i||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var r=s===$.DOWN_KEY||s===$.PAGE_DOWN_KEY?1:-1,o=t.metaKey||s===$.PAGE_DOWN_KEY||s===$.PAGE_UP_KEY,l=void 0;if(o)r>0?l=this.dropdown.element.querySelector("".concat(we,":last-of-type")):l=this.dropdown.element.querySelector(we);else{var u=this.dropdown.element.querySelector(Ce(this.config.classNames.highlightedState));u?l=_i(u,we,r):l=this.dropdown.element.querySelector(we)}l&&(vi(l,this.choiceList.element,r)||this.choiceList.scrollToChildElement(l,r),this._highlightChoice(l)),t.preventDefault()}},e.prototype._onDeleteKey=function(t,i,s){!this._isSelectOneElement&&!t.target.value&&s&&(this._handleBackspace(i),t.preventDefault())},e.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},e.prototype._onTouchEnd=function(t){var i=(t||t.touches[0]).target,s=this._wasTap&&this.containerOuter.element.contains(i);if(s){var r=i===this.containerOuter.element||i===this.containerInner.element;r&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),t.stopPropagation()}this._wasTap=!0},e.prototype._onMouseDown=function(t){var i=t.target;if(i instanceof HTMLElement){if(wn&&this.choiceList.element.contains(i)){var s=this.choiceList.element.firstElementChild;this._isScrollingOnIe=this._direction==="ltr"?t.offsetX>=s.offsetWidth:t.offsetX<s.offsetLeft}if(i!==this.input.element){var r=i.closest("[data-button],[data-item],[data-choice]");r instanceof HTMLElement&&("button"in r.dataset?this._handleButtonAction(r):"item"in r.dataset?this._handleItemAction(r,t.shiftKey):"choice"in r.dataset&&this._handleChoiceAction(r)),t.preventDefault()}}},e.prototype._onMouseOver=function(t){var i=t.target;i instanceof HTMLElement&&"choice"in i.dataset&&this._highlightChoice(i)},e.prototype._onClick=function(t){var i=t.target,s=this.containerOuter,r=s.element.contains(i);r?!this.dropdown.isActive&&!s.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),s.element.focus()):this._isSelectOneElement&&i!==this.input.element&&!this.dropdown.element.contains(i)&&this.hideDropdown():(s.removeFocusState(),this.hideDropdown(!0),this.unhighlightAll())},e.prototype._onFocus=function(t){var i=t.target,s=this.containerOuter,r=i&&s.element.contains(i);if(r){var o=i===this.input.element;this._isTextElement?o&&s.addFocusState():this._isSelectMultipleElement?o&&(this.showDropdown(!0),s.addFocusState()):(s.addFocusState(),o&&this.showDropdown(!0))}},e.prototype._onBlur=function(t){var i=t.target,s=this.containerOuter,r=i&&s.element.contains(i);r&&!this._isScrollingOnIe?i===this.input.element?(s.removeFocusState(),this.hideDropdown(!0),(this._isTextElement||this._isSelectMultipleElement)&&this.unhighlightAll()):i===this.containerOuter.element&&s.removeFocusState():(this._isScrollingOnIe=!1,this.input.element.focus())},e.prototype._onFormReset=function(){var t=this;this._store.withTxn(function(){t.clearInput(),t.hideDropdown(),t.refresh(!1,!1,!0),t._initialItems.length&&t.setChoiceByValue(t._initialItems)})},e.prototype._highlightChoice=function(t){t===void 0&&(t=null);var i=Array.from(this.dropdown.element.querySelectorAll(we));if(i.length){var s=t,r=this.config.classNames.highlightedState,o=Array.from(this.dropdown.element.querySelectorAll(Ce(r)));o.forEach(function(l){ue(l,r),l.setAttribute("aria-selected","false")}),s?this._highlightPosition=i.indexOf(s):(i.length>this._highlightPosition?s=i[this._highlightPosition]:s=i[i.length-1],s||(s=i[0])),P(s,r),s.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(se.highlightChoice,{el:s}),this.dropdown.isActive&&(this.input.setActiveDescendant(s.id),this.containerOuter.setActiveDescendant(s.id))}},e.prototype._addItem=function(t,i,s){if(i===void 0&&(i=!0),s===void 0&&(s=!1),!t.id)throw new TypeError("item.id must be set before _addItem is called for a choice/item");(this.config.singleModeForMultiSelect||this._isSelectOneElement)&&this.removeActiveItems(t.id),this._store.dispatch(pi(t)),i&&(this.passedElement.triggerEvent(se.addItem,this._getChoiceForOutput(t)),s&&this.passedElement.triggerEvent(se.choice,this._getChoiceForOutput(t)))},e.prototype._removeItem=function(t){if(t.id){this._store.dispatch(gt(t));var i=this._notice;i&&i.type===ee.noChoices&&this._clearNotice(),this.passedElement.triggerEvent(se.removeItem,this._getChoiceForOutput(t))}},e.prototype._addChoice=function(t,i,s){if(i===void 0&&(i=!0),s===void 0&&(s=!1),t.id)throw new TypeError("Can not re-add a choice which has already been added");var r=this.config;if(!((this._isSelectElement||!r.duplicateItemsAllowed)&&this._store.choices.find(function(u){return r.valueComparer(u.value,t.value)}))){this._lastAddedChoiceId++,t.id=this._lastAddedChoiceId,t.elementId="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(t.id);var o=r.prependValue,l=r.appendValue;o&&(t.value=o+t.value),l&&(t.value+=l.toString()),(o||l)&&t.element&&(t.element.value=t.value),this._clearNotice(),this._store.dispatch(ci(t)),t.selected&&this._addItem(t,i,s)}},e.prototype._addGroup=function(t,i){var s=this;if(i===void 0&&(i=!0),t.id)throw new TypeError("Can not re-add a group which has already been added");this._store.dispatch(hi(t)),t.choices&&(this._lastAddedGroupId++,t.id=this._lastAddedGroupId,t.choices.forEach(function(r){r.group=t,t.disabled&&(r.disabled=!0),s._addChoice(r,i)}))},e.prototype._createTemplates=function(){var t=this,i=this.config.callbackOnCreateTemplates,s={};typeof i=="function"&&(s=i.call(this,gi,st,Be));var r={};Object.keys(this._templates).forEach(function(o){o in s?r[o]=s[o].bind(t):r[o]=t._templates[o].bind(t)}),this._templates=r},e.prototype._createElements=function(){var t=this._templates,i=this,s=i.config,r=i._isSelectOneElement,o=s.position,l=s.classNames,u=this._elementType;this.containerOuter=new Et({element:t.containerOuter(s,this._direction,this._isSelectElement,r,s.searchEnabled,u,s.labelId),classNames:l,type:u,position:o}),this.containerInner=new Et({element:t.containerInner(s),classNames:l,type:u,position:o}),this.input=new Ti({element:t.input(s,this._placeholderValue),classNames:l,type:u,preventPaste:!s.paste}),this.choiceList=new It({element:t.choiceList(s,r)}),this.itemList=new It({element:t.itemList(s,r)}),this.dropdown=new Ai({element:t.dropdown(s),classNames:l,type:u})},e.prototype._createStructure=function(){var t=this,i=t.containerInner,s=t.containerOuter,r=t.passedElement,o=this.dropdown.element;r.conceal(),i.wrap(r.element),s.wrap(i.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":(this._placeholderValue&&(this.input.placeholder=this._placeholderValue),this.input.setWidth()),s.element.appendChild(i.element),s.element.appendChild(o),i.element.appendChild(this.itemList.element),o.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&o.insertBefore(this.input.element,o.firstChild):i.element.appendChild(this.input.element),this._highlightPosition=0,this._isSearching=!1},e.prototype._initStore=function(){var t=this;this._store.subscribe(this._render).withTxn(function(){t._addPredefinedChoices(t._presetChoices,t._isSelectOneElement&&!t._hasNonChoicePlaceholder,!1)}),(!this._store.choices.length||this._isSelectOneElement&&this._hasNonChoicePlaceholder)&&this._render()},e.prototype._addPredefinedChoices=function(t,i,s){var r=this;if(i===void 0&&(i=!1),s===void 0&&(s=!0),i){var o=t.findIndex(function(l){return l.selected})===-1;o&&t.some(function(l){return l.disabled||"choices"in l?!1:(l.selected=!0,!0)})}t.forEach(function(l){"choices"in l?r._isSelectElement&&r._addGroup(l,s):r._addChoice(l,s)})},e.prototype._findAndSelectChoiceByValue=function(t,i){var s=this;i===void 0&&(i=!1);var r=this._store.choices.find(function(o){return s.config.valueComparer(o.value,t)});return r&&!r.disabled&&!r.selected?(this._addItem(r,!0,i),!0):!1},e.prototype._generatePlaceholderValue=function(){var t=this.config;if(!t.placeholder)return null;if(this._hasNonChoicePlaceholder)return t.placeholderValue;if(this._isSelectElement){var i=this.passedElement.placeholderOption;return i?i.text:null}return null},e.prototype._warnChoicesInitFailed=function(t){if(!this.config.silent)if(this.initialised){if(!this.initialisedOK)throw new TypeError("".concat(t," called for an element which has multiple instances of Choices initialised on it"))}else throw new TypeError("".concat(t," called on a non-initialised instance of Choices"))},e.version="11.0.3",e}();var Wt=oi(jt(),1);function Tn({state:e,webPkiSignature:t,debug:i=!1,canSelectPlaceholder:s,isHtmlAllowed:r,getOptionLabelUsing:o,getOptionLabelsUsing:l,getOptionsUsing:u,getSearchResultsUsing:d,isAutofocused:f,isMultiple:h,isSearchable:m,hasDynamicOptions:v,hasDynamicSearchResults:w,loadingMessage:g,maxItems:I,maxItemsMessage:B,noSearchResultsMessage:L,options:G,optionsLimit:q,placeholder:te,position:_e,searchPrompt:X,searchableOptionFields:Q,statePath:ne,onWebPkiNotInstalledUsing:ae}){return{isSearching:!1,selectedOptions:[],isStateBeingUpdated:!1,state:e,certificates:[],debug:i,selectInput:null,pki:null,select:null,token:null,blockUIElement:null,init:async function(){this.blockUIElement=document.getElementById("loadingBlockUI"),this.select=new qt(this.$refs.input,{allowHTML:r,duplicateItemsAllowed:!1,itemSelectText:"",loadingText:g,maxItemCount:I??-1,maxItemText:R=>window.pluralize(B,R,{count:R}),noChoicesText:X,noResultsText:L,placeholderValue:te,position:_e??"auto",removeItemButton:s,renderChoiceLimit:q,searchEnabled:m,searchFields:Q??["label"],searchPlaceholderValue:X,searchResultLimit:q,shouldSort:!1,searchFloor:w?0:1}),await this.refreshChoices({withInitialOptions:!0}),[null,void 0,""].includes(this.state)||this.select.setChoiceByValue(this.formatState(this.state)),this.refreshPlaceholder(),f&&this.select.showDropdown(),this.$refs.input.addEventListener("change",()=>{this.refreshPlaceholder(),!this.isStateBeingUpdated&&(this.isStateBeingUpdated=!0,this.state=this.select.getValue(!0)??null,this.$nextTick(()=>this.isStateBeingUpdated=!1))}),this.$watch("state",async()=>{this.select&&(this.refreshPlaceholder(),!this.isStateBeingUpdated&&await this.refreshChoices({withInitialOptions:!v}))}),this.log("Initializing Web PKI component ...",e),this.showLoadingBlockUI(),this.pki=new Wt.LacunaWebPKI(t),await this.pki.init({ready:()=>{this.pki.listCertificates().success(async R=>{this.certificates=R,this.select.clearChoices(),await this.select.setChoices([{label:g,value:"",disabled:!0}]),this.log("Get options from certificates ...",ne,R);let j=await this.$wire.generateSelectOptionsFromCertificates(ne,R);this.setChoices(j),this.hiddenLoadingBlockUI()})},notInstalled:async(R,j)=>{this.log("Web PKI not installed."),this.hiddenLoadingBlockUI();let W={installUrl:this.pki._installUrl,brand:this.pki.brand||"",jslib:this.pki._jslibVersion,returnUrl:window.location.href};ae(R,j,W)},defaultError:R=>{this.log("An error has occurred: "+R),this.hiddenLoadingBlockUI()}}),this.$wire.on("signPAdES",R=>{this.token=R.token,this.log("Signing PAdES ...",this.state,this.token,R),this.signPAdES()})},log(...R){this.debug&&console.debug(R)},signPAdES:async function(){this.log("Signing PAdES ...",this.state),await this.pki.signWithRestPki({token:this.token,thumbprint:this.state}).success(()=>{this.$wire.dispatch("signedPAdES",{token:this.token,thumbprint:this.state})})},destroy:function(){this.select.destroy(),this.select=null},refreshChoices:async function(R={}){let j=await this.getChoices(R);this.select&&(this.select.clearStore(),this.refreshPlaceholder(),this.setChoices(j),[null,void 0,""].includes(this.state)||this.select.setChoiceByValue(this.formatState(this.state)))},setChoices:function(R){this.select.setChoices(R,"value","label",!0)},getChoices:async function(R={}){let j=await this.getExistingOptions(R);return j.concat(await this.getMissingOptions(j))},getExistingOptions:async function({search:R,withInitialOptions:j}){if(j)return G;let W=[];return R!==""&&R!==null&&R!==void 0?W=await d(R):W=await u(),W.map(n=>n.choices?(n.choices=n.choices.map(a=>(a.selected=Array.isArray(this.state)?this.state.includes(a.value):this.state===a.value,a)),n):(n.selected=Array.isArray(this.state)?this.state.includes(n.value):this.state===n.value,n))},refreshPlaceholder:function(){h||(this.select._renderItems(),[null,void 0,""].includes(this.state)&&(this.$el.querySelector(".choices__list--single").innerHTML=`<div class="choices__placeholder choices__item">${te??""}</div>`))},formatState:function(R){return h?(R??[]).map(j=>j?.toString()):R?.toString()},getMissingOptions:async function(R){let j=this.formatState(this.state);if([null,void 0,"",[],{}].includes(j))return{};let W=new Set;return R.forEach(n=>{if(n.choices){n.choices.forEach(a=>W.add(a.value));return}W.add(n.value)}),h?j.every(n=>W.has(n))?{}:(await l()).filter(n=>!W.has(n.value)).map(n=>(n.selected=!0,n)):W.has(j)?W:[{label:await o(),value:j,selected:!0}]},showLoadingBlockUI:function(){this.blockUIElement&&(this.blockUIElement.style.display="flex")},hiddenLoadingBlockUI:function(){this.blockUIElement&&(this.blockUIElement.style.display="none")}}}export{Tn as default};
/*! Bundled license information:

choices.js/public/assets/scripts/choices.mjs:
  (*! choices.js v11.0.3 |  2024 Josh Johnson | https://github.com/jshjohnson/Choices#readme *)
*/
